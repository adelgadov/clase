Ejercicios 1º ASIR
=======================


Ejercicios
---------------


```sql

    EJER.1 (ejer.1 de la pagina 127)
     -SELECT APELLIDO, OFICIO, DNOMBRE FROM EMPLE, DEPART 
       WHERE OFICIO= 'EMPLEADO' AND DNOMBRE= 'VENTAS' AND DEPART.DEPT_NO=EMPLE.DEPT_NO;
     
       -SELECT APELLIDO, OFICIO, LOC FROM EMPLE, DEPART
       WHERE OFICIO='ANALISTA' AND DEPART.DEPT_NO=EMPLE.DEPT_NO;
       
      EJER.2(ejer.3 de la pagina 127)
     -SELECT * FROM EMPLE, DEPART
       WHERE DNOMBRE= 'VENTAS' AND DEPART.DEPT_NO=EMPLE.DEPT_NO;
     
       -SELECT * FROM EMPLE, DEPART
       WHERE DEPT_NO = (SELECT DEPT_NO FROM DEPART WHERE DNOMBRE='VENTAS');
     
      EJER.3(ejer.4 de la pagina 127)
     -SELECT * FROM DEPART
       WHERE NOT EXISTS (SELECT * FROM EMPLE WHERE EMPLE.DEPT_NO=DEPART.DEPT_NO);
     
     -SELECT * FROM DEPART
       WHERE DEPT_NO NOT IN (SELECT DISTINCT DEPT_NO FROM EMPLE);
     
      EJER.4(ejer.5 de la pagina 127)
     -SELECT * FROM DEPART
       WHERE EXISTS (SELECT * FROM EMPLE WHERE EMPLE.DEPT_NO=DEPART.DEPT_NO);
     
     -SELECT * FROM DEPART
       WHERE DEPT_NO IN (SELECT DISTINCT DEPT_NO FROM EMPLE);
     
      EJER.5(ejer.2 de la pagina 127)
     -SELECT * FROM EMPLE
       WHERE DIR = (SELECT EMP_NO FROM EMPLE WHERE APELLIDO = 'CEREZO');
     
      EJER.6(ejer.6 de la pagina 127)
     -SELECT * FROM EMPLE
       WHERE SALARIO > (SELECT MAX(SALARIO) FROM EMPLE WHERE DEPT_NO =20);
     
      EJER.7(ejer.7 de la pagina 127)
     -SELECT * FROM LIBRERIA
       WHERE EJEMPLARES BETWEEN 8 AND 15;
     
      EJER.8(ejer.8 de la pagina 127)
     -SELECT * FROM LIBRERIA
       WHERE ESTANTE NOT BETWEEN 'B' AND 'D';
     
      EJER.9(jer.9 de la pagina 127)
     -SELECT TEMA FROM LIBRERIA
       WHERE EJEMPLARES < (SELECT EJEMPLARES FROM LIBRERIA WHERE TEMA = 'MEDICINA');
     
      EJER.10(ejer.10 de la pagina 127)
     -SELECT TEMA FROM LIBRERIA
       WHERE EJEMPLARES NOT BETWEEN 15 AND 20;
     
      EJER.11(ejer.15 de la pagina 127)
     -SELECT APENOM FROM ALUMNOS
       WHERE DNI IN (SELECT DNI FROM NOTAS WHERE COD = 1);
     
     -SELECT APENOM FROM ALUMNOS, NOTAS
       WHERE ALUMNOS.DNI=NOTAS.DNI AND COD = 1;
     
      EJER.12(ejer.16 de la pagina 127)
     -SELECT APENOM FROM ALUMNOS
       WHERE DNI NOT IN (SELECT DNI FROM NOTAS 
        WHERE COD = 1);
     
     -SELECT APENOM FROM ALUMNOS, NOTAS
       WHERE ALUMNOS.DNI=NOTAS.DNI AND COD <> 1;
     
      EJER.13(ejer.14 de la pagina 127)
     -SELECT * FROM ASIGNATURAS
       WHERE COD NOT IN (SELECT DISTINCT COD FROM NOTAS);
     
      EJER.12(ejer.12 de la pagina 127)
     -SELECT APENOM FROM ALUMNOS
       WHERE POBLA = 'Madrid' AND DNI IN (SELECT DNI FROM NOTAS 
        WHERE NOTA < 5);
     
      EJER.13(ejer.11 de la pagina 127)
     -SELECT NOMBRE FROM ASIGNATURAS 
       WHERE NOMBRE LIKE '%o%o%o%' AND COD IN (SELECT COD FROM NOTAS 
        WHERE DNI IN (SELECT DNI FROM ALUMNOS 
         WHERE POBLA = 'Madrid'));
     
      EJER.14(ejer.13 de la pagina 127)
     -SELECT APENOM FROM ALUMNOS 
       WHERE DNI IN (SELECT DISTINCT  DNI FROM NOTAS 
        WHERE NOTA = (SELECT NOTA FROM NOTAS 
         WHERE COD = (SELECT COD FROM ASIGNATURAS 
          WHERE NOMBRE = 'FOL') AND DNI IN (SELECT DNI FROM ALUMNOS WHERE APENOM = 'Díaz Fernández, María')));
     
      EJER.15
     -SELECT APELLIDO, OFICIO, SALARIO FROM EMPLE E 
       WHERE SALARIO = (SELECT MIN(SALARIO) FROM EMPLE 
        WHERE OFICIO = E.OFICIO) ORDER BY OFICIO;
     
      EJER.16(ejer.1 de ejercicios de refuerzos)
     -SELECT AVG(SALARIO) FROM EMPLE
       WHERE DEPT_NO IN (SELECT DEPT_NO FROM DEPART
        WHERE DNOMBRE = 'VENTAS');
     
      EJER.17(ejer.2 de ejercicios de refuerzos)
     -SELECT APELLIDO FROM EMPLE
       WHERE DEPT_NO = (SELECT DEPT_NO FROM EMPLE
        WHERE APELLIDO = 'JIMENEZ');
     
      EJER.18(ejer.3 de ejercicios de refuerzos)
     -SELECT APELLIDO FROM EMPLE
       WHERE OFICIO = (SELECT OFICIO FROM EMPLE 
        WHERE APELLIDO = 'GIL');
     
      EJER.19(ejer.4 de ejercicios de refuerzos)
     -SELECT * FROM EMPLE
      WHERE OFICIO = (SELECT OFICIO FROM EMPLE WHERE APELLIDO = 'JIMENEZ') AND DEPT_NO = (SELECT DEPT_NO FROM EMPLE WHERE APELLIDO = 'ALONSO');
     
      EJER.20(ejer.5 de ejercicios de refuerzos)
     -SELECT COUNT(APELLIDO) FROM EMPLE
      WHERE DEPT_NO = 10;
     
      EJER.21(ejer.6 de ejercicios de refuerzos)
     -SELECT APELLIDO FROM EMPLE 
      WHERE OFICIO LIKE '%O%'
     
      EJER.22(ejer.7 de ejercicios de refuerzos)
     -SELECT APELLIDO FROM EMPLE 
      WHERE  DEPT_NO IN (10, 20);
     
      EJER.23(ejer.8 de ejercicios de refuerzos)
     -SELECT TEMA FROM LIBRERIA
      WHERE EJEMPLARES > 10;
     
      EJER.24(ejer.9 de ejercicios de refuerzos)
     -SELECT APELLIDO, OFICIO, SALARIO FROM EMPLE E
      WHERE SALARIO = (SELECT MAX(SALARIO) FROM EMPLE 
       WHERE OFICIO=E.OFICIO);
     
      EJER.25(ejer.10 de ejercicios de refuerzos)
     -SELECT APELLIDO, DNOMBRE, SALARIO FROM DEPART D, EMPLE E
       WHERE SALARIO = (SELECT MIN(SALARIO) FROM EMPLE 
        WHERE DEPT_NO=E.DEPT_NO)AND D.DEPT_NO=E.DEPT_NO;
     
      EJER.26(ejer.11 de ejercicios de refuerzos)
     -SELECT APENOM FROM ALUMNOS
      WHERE DNI IN (SELECT DNI FROM NOTAS
       WHERE NOTA <= 4 AND COD IN (SELECT COD FROM ASIGNATURAS
        WHERE NOMBRE = 'FOL'));
       
      EJER.27(ejer.12 de ejercicios de refuerzos)
     -SELECT APENOM FROM ALUMNOS
      WHERE DNI IN (SELECT DNI FROM NOTAS 
       WHERE NOTA >4 AND COD = (SELECT COD FROM ASIGNATURAS 
        WHERE NOMBRE = 'Aplic. Entornos 4ªGen'));
     
      EJER.28(ejer.13 de ejercicios de refuerzos)
     -SELECT APENOM FROM ALUMNOS
      WHERE DNI IN (SELECT DNI FROM NOTAS
       WHERE COD IN (SELECT COD FROM ASIGNATURAS 
        WHERE NOMBRE IN ('Prog. Leng. Estr.', 'Sist. Informáticos', 'Análisis')));
     
      EJER.29(ejer.14 de ejercicios de refuerzos)
     -SELECT APENOM FROM ALUMNOS
      WHERE DNI IN (SELECT DNI FROM NOTAS
       WHERE NOTA <5 AND COD IN (SELECT COD FROM ASIGNATURAS 
        WHERE NOMBRE IN ('Prog. Leng. Estr.', 'Sist. Informáticos', 'Análisis')));
     
      EJER.30(ejer.15 de ejercicios de refuerzos)
     -SELECT APENOM FROM ALUMNOS 
      WHERE POBLA = 'Madrid' AND DNI NOT IN (SELECT DISTINCT DNI FROM NOTAS 
       WHERE NOTA <= 4);
     
      EJER.31(ejer.16 de ejercicios de refuerzos)
     -SELECT APENOM, NOMBRE FROM ALUMNOS A, ASIGNATURAS ASIG, NOTAS N
      WHERE A.DNI=N.DNI AND ASIG.COD=N.COD AND NOTA < 5;
     
      EJER.32(ejer.17 de ejercicios de refuerzos)
     -SELECT APENOM, NOMBRE, NOTA FROM ALUMNOS, ASIGNATURAS, NOTAS
      WHERE ALUMNOS.DNI = NOTAS.DNI AND ASIGNATURAS.COD = NOTAS.COD AND NOTA > 4 ORDER BY APENOM;
     
      EJER.33(ejer.18 de ejercicios de refuerzos)
     -SELECT APENOM, NOTA, NOMBRE FROM ASIGNATURAS, NOTAS, ALUMNOS
      WHERE POBLA = 'Madrid' AND NOTA < 5 AND ASIGNATURAS.COD=NOTAS.COD AND ALUMNOS.DNI=NOTAS.DNI;
     
      EJER.34(ejer.19 de ejercicios de refuerzos)
     -SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM ARTICULOS 
     WHERE (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA) NOT IN (SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM PEDIDOS) AND (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA) NOT IN (SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM VENTAS);
     
      EJER.35(ejer.20 de ejercicios de refuerzos)
     -SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM ARTICULOS 
      WHERE (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA) IN (SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM PEDIDOS) AND (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA) IN (SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM VENTAS) ORDER BY ARTICULO;
     
      EJER.36(ejer.21 de ejercicios de refuerzos)
     -SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM VENTAS
      WHERE COD_FABRICANTE IN (SELECT DISTINCT COD_FABRICANTE FROM FABRICANTES) ORDER BY ARTICULO;
     
      EJER.37(ejer.1 de ejercicios de pag.133)
     ABS(146)=146    ABS(-30)=30      POWER(3, -1)=1/3          ROUND(33.67)=34
     CEIL(2)=2       CEIL(1.3)=2      ROUND(-33.67, 2)=-33.67   ROUND(-33.67, -2)= 0
     CEIL(-2.3)=-2   CEIL(-2)=2       ROUND(-33.27, 1)=-33.3    ROUND(-33.27, -1)= 30
     FLOOR(-2)=-2    FLOOR(-2.3)=-3   TRUNC(67.232)=67          TRUNC(67.232, -2)=0
     FLOOR(2)=2      FLOOR(1.3)=1     TRUNC(67.232, 2)=61.23    TRUNC(67.58, -1)=60
     MOD(22, 23)=22  MOD(10, 3)=1     TRUNC(67.58, 1)=67.6
     POWER(10, 0)=1  POWER(3, 2)=9
     
      EJER.38(ejer.2 de ejercicios de pag.136)
     -SELECT COUNT(APELLIDO)FROM EMPLE
     WHERE APELLIDO LIKE 'A%';
     
     -SELECT APELLIDO FROM EMPLE
     WHERE APELLIDO LIKE 'A%' AND SALARIO IN (SELECT MAX(SALARIO) FROM EMPLE WHERE APELLIDO LIKE 'A%');
     
     EJER.39(ejer.1 de ejercicios de pag.155)
     -SELECT AVG(SALARIO), COUNT(COMISION), MAX(SALARIO), MIN(SALARIO) FROM EMPLE
     WHERE DEPT_NO = 30;
     
      EJER.40(ejer.2 de ejercicios de pag.155)
     -SELECT TEMA FROM LIBRERIA
     WHERE TEMA LIKE '%E%' AND EJEMPLARES IN (SELECT MAX(EJEMPLARES)FROM LIBRERIA WHERE TEMA LIKE '%E%');
     
      EJER.41(ejer.3 de ejercicios de pag.155)
     -SELECT RPAD(RTRIM(LTRIM(TITULO,'"'),'", .'),40,'_^') FROM MISTEXTOS;
     
      EJER.42(ejer.4 de ejercicios de pag.155)
     -SELECT LOWER(RTRIM(LTRIM(TITULO,'"'),'", .')) FROM MISTEXTOS;
     
     EJER.43(ejer.5 de ejercicios de pag.155)
     -SELECT AUTOR, SUBSTR(AUTOR, 1, INSTR(AUTOR, ',', 1, 1)-1) FROM LIBROS;
     
      EJER.44(ejer.6 de ejercicios de pag.155)
     -SELECT AUTOR, SUBSTR(AUTOR, INSTR(AUTOR, ',', 1, 1)+2, LENGTH(AUTOR)) FROM LIBROS;
      
      EJER.45(ejer.7 de ejercicios de pag.155)
     -SELECT CONCAT(CONCAT(SUBSTR(AUTOR, INSTR(AUTOR, ',',1,1)+2, LENGTH(AUTOR)), ' '),SUBSTR(AUTOR, 1, INSTR(AUTOR, ',', 1, 1)-1)) FROM LIBROS;
      
      EJER.46(ejer.8 de ejercicios de pag.155)
     -SELECT TITULO FROM LIBROS ORDER BY LENGTH(TITULO);
      
      EJER.47(ejer.14 de ejercicios de pag.155)
     -SELECT APELLIDO FROM EMPLE
     WHERE TRUNC(MONTHS_BETWEEN(SYSDATE, FECHA_ALT))/12 > 15;
      
      EJER.48(ejer.15 de ejercicios de pag.155)
     -SELECT APELLIDO FROM EMPLE
     WHERE TRUNC(MONTHS_BETWEEN(SYSDATE, FECHA_ALT))/12 > 16 AND DEPT_NO IN (SELECT DEPT_NO FROM DEPART
     WHERE DNOMBRE = 'VENTAS');
      
      EJER.49(ejer.16 de ejercicios de pag.155)
     -SELECT APELLIDO, SALARIO, DEPT_NO FROM EMPLE E
     WHERE SALARIO IN (SELECT MAX(SALARIO)FROM EMPLE WHERE E.DEPT_NO=EMPLE.DEPT_NO) ORDER BY DEPT_NO;
     
      EJER.50(ejer.17 de ejercicios de pag.155)
     -SELECT APELLIDO, SALARIO, DEPT_NO FROM EMPLE E
     WHERE SALARIO IN (SELECT MAX(SALARIO)FROM EMPLE 
     WHERE E.DEPT_NO=EMPLE.DEPT_NO AND SALARIO > (SELECT AVG(SALARIO) FROM EMPLE 
     WHERE E.DEPT_NO=EMPLE.DEPT_NO)) ORDER BY DEPT_NO;
     
      EJER.51(ejer.9 de ejercicios de pag.155)
     -SELECT NOMBRE, FECHANAC, TO_CHAR(FECHANAC, ' "Nacio el" DD " de " MONTH " de " YYYY') FROM NACIMIENTOS;
     
      EJER.52(ejer.11 de ejercicios de pag.155)
     -SELECT CONCAT(NOMBRE, TO_CHAR(FECHANAC, ' "Nacio el" DD " de " MONTH " de " YYYY')) FROM NACIMIENTOS;
     
      EJER.53(ejer.12 de ejercicios de pag.155)
     -SELECT TO_CHAR(TO_DATE('010712', 'ddmmyy'), '"Fecha: El " dd "de " MONTH "de " YYYY') FROM DUAL;
     
      EJER.54(ejer.10 de ejercicios de pag.155)
     -SELECT TEMA, SUBSTR(RTRIM(TEMA, ' '),-1, 1),LENGTH(RTRIM(TEMA, ' '))  FROM LIBRERIA;
     
      EJER.55(ejer.1 de ejercicios de refuerzo tema 4)
     -SELECT SALARIO, APELLIDO FROM EMPLE
     WHERE SALARIO IN (SELECT MAX(SALARIO) FROM EMPLE 
     WHERE DEPT_NO=10) AND DEPT_NO=10;
     
      EJER.56(ejer.2 de ejercicios de refuerzo tema 4)
     -SELECT SALARIO, APELLIDO FROM EMPLE
     WHERE SALARIO < (SELECT AVG(SALARIO) FROM EMPLE WHERE DEPT_NO=20) AND DEPT_NO=20;
     
      EJER.57(ejer.3 de ejercicios de refuerzo tema 4)
     -SELECT SALARIO, APELLIDO FROM EMPLE
     WHERE OFICIO = 'VENDEDOR' AND SALARIO > (SELECT AVG(SALARIO) FROM EMPLE WHERE OFICIO = 'VENDEDOR');
     
      EJER.58(ejer.4 de ejercicios de refuerzo tema 4)
     -SELECT SALARIO, APELLIDO FROM EMPLE
     WHERE SALARIO > (SELECT AVG(SALARIO) FROM EMPLE WHERE DEPT_NO = 20);
     
      EJER.59(ejer.5 de ejercicios de refuerzo tema 4)
     -SELECT SALARIO, APELLIDO FROM EMPLE
     WHERE SALARIO > (SELECT AVG(SALARIO) FROM EMPLE);
     
      EJER.60(ejer.6 de ejercicios de refuerzo tema 4)
     -SELECT MAX(GREATEST(NOTA1, NOTA2, NOTA3)) FROM NOTAS_ALUMNOS;
     
      EJER.61(ejer.7 de ejercicios de refuerzo tema 4)
     -SELECT NOMBRE_ALUMNO, GREATEST(NOTA1, NOTA2, NOTA3) FROM NOTAS_ALUMNOS
     WHERE GREATEST(NOTA1, NOTA2, NOTA3) = ( SELECT MAX(GREATEST(NOTA1, NOTA2, NOTA3)) FROM NOTAS_ALUMNOS);
     
      EJER.62(ejer.8 de ejercicios de refuerzo tema 4)
     -SELECT TITULO FROM MISTEXTOS
     WHERE TITULO LIKE '% % %';
     
      EJER.63(ejer.9 de ejercicios de refuerzo tema 4)
     -SELECT CONCAT(AUTOR,CONCAT(' ', CONCAT('escribio', CONCAT(' ', (RTRIM(LTRIM(TITULO, '"'),'.,"')))))) FROM MISTEXTOS;
     
      EJER.64(ejer.10 de ejercicios de refuerzo tema 4)
     -SELECT APELLIDO FROM EMPLE
     WHERE TRUNC(MONTHS_BETWEEN(SYSDATE,FECHA_ALT)/12) > 25;
     
      EJER.65(ejer.11 de ejercicios de refuerzo tema 4)
     -SELECT APELLIDO, TRUNC(MONTHS_BETWEEN(SYSDATE,FECHA_ALT)/12) FROM EMPLE E
     WHERE TRUNC(MONTHS_BETWEEN(SYSDATE,FECHA_ALT)/12) IN (SELECT MAX(TRUNC(MONTHS_BETWEEN(SYSDATE,FECHA_ALT)/12)) FROM EMPLE WHERE E.DEPT_NO=EMPLE.DEPT_NO);
     
      EJER.66(ejer.12 de ejercicios de refuerzo tema 4)
     -SELECT APELLIDO, OFICIO FROM EMPLE E
     WHERE TRUNC(MONTHS_BETWEEN(SYSDATE,FECHA_ALT)/12) IN (SELECT MIN(TRUNC(MONTHS_BETWEEN(SYSDATE,FECHA_ALT)/12)) FROM EMPLE WHERE E.OFICIO=EMPLE.OFICIO);
     
      EJER.67(ejer.13 de ejercicios de refuerzo tema 4)
     -SELECT TO_CHAR(SYSDATE, '"Hoy es" DD " de " month " de " YYYY') FROM DUAL;
     
      EJER.68(ejer.14 de ejercicios de refuerzo tema 4)
     -SELECT TO_CHAR(SYSDATE, '"-" DD "-" month "-" YY "-"') FROM DUAL;
     
      EJER.69(ejer.15 de ejercicios de refuerzo tema 4)
     -SELECT TO_CHAR(SYSDATE, 'j') FROM DUAL;
     
      EJER.70(ejer.16 de ejercicios de refuerzo tema 4)
     -SELECT ROUND(MONTHS_BETWEEN(SYSDATE, '01/01/2015'), 2) FROM DUAL;
     
      EJER.71(ejer.17 de ejercicios de refuerzo tema 4)
     -SELECT ROUND(MONTHS_BETWEEN(SYSDATE,TO_DATE(010120, 'ddmmyy'))*30,0) FROM DUAL;
     
      EJER.72(ejer.18 de ejercicios de refuerzo  tema 4)
     -SELECT ARTICULO, FECHA_VENTA, ADD_MONTHS(FECHA_VENTA, 1) FROM VENTAS;
     
      EJER.73(ejer.19 de ejercicios de refuerzo tema 4)
     -SELECT ARTICULO, FECHA_VENTA, TO_CHAR(ADD_MONTHS(FECHA_VENTA, 1), 'dd-MM-YYYY') FROM VENTAS;
     
      EJER.74(ejer.20 de ejercicios de refuerzo tema 4)
     -SELECT CONCAT(LTRIM(SUBSTR(AUTOR,INSTR(AUTOR, ',')), ', '), CONCAT(' ', RTRIM(SUBSTR(AUTOR, 1, INSTR(AUTOR, ',')), ','))) AUTOR FROM LIBROS;
     
      EJER.75(ejer.1 dictado)
     -SELECT COD_FABRICANTE, COUNT(*) FROM ARTICULOS GROUP BY COD_FABRICANTE;
     
      EJER.75(ejer.2 dictado)
     -SELECT COD_FABRICANTE, COUNT(*) FROM ARTICULOS GROUP BY COD_FABRICANTE HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM ARTICULOS GROUP BY COD_FABRICANTE);
     
      EJER.75(ejer.3 dictado)
     -SELECT CATEGORIA, COUNT(*) FROM ARTICULOS GROUP BY CATEGORIA;
     
      EJER.75(ejer.4 dictado)
     -SELECT CATEGORIA, COUNT(*) FROM ARTICULOS GROUP BY CATEGORIA HAVING COUNT(*)=(SELECT MIN(COUNT(*)) FROM ARTICULOS GROUP BY CATEGORIA);
     
      EJER.76(ejer.1 de la pagina 167)
     -SELECT OFICIO, SUM(SALARIO) FROM EMPLE
     WHERE DEPT_NO = (SELECT DEPT_NO FROM DEPART WHERE DNOMBRE='VENTAS')
     GROUP BY OFICIO;
     
      EJER.77(ejer.2 de la pagina 167)
     -SELECT APELLIDO, SALARIO FROM EMPLE
     WHERE (DEPT_NO, SALARIO) IN (SELECT DEPT_NO, TRUNC(AVG(SALARIO)) FROM EMPLE GROUP BY DEPT_NO);
     
      EJER.78(ejer.3 de la pagina 168)
     -SELECT DEPT_NO, COUNT(*) FROM EMPLE
     WHERE OFICIO='EMPLEADO' GROUP BY DEPT_NO;
     
      EJER.79(ejer.4 de la pagina 169)
     -SELECT DEPT_NO, COUNT(*) FROM EMPLE
     WHERE OFICIO='EMPLEADO'
     GROUP BY DEPT_NO
     HAVING COUNT(*)=(SELECT MAX(COUNT(*)) FROM EMPLE WHERE OFICIO='EMPLEADO' GROUP BY DEPT_NO);
     
      EJER.80(ejer.5 de la pagina 169)
     -SELECT DNOMBRE, DEPT_NO FROM DEPART WHERE DEPT_NO IN 
     (SELECT DEPT_NO FROM EMPLE WHERE OFICIO='EMPLEADO'
     GROUP BY DEPT_NO
     HAVING COUNT(*)=(SELECT MAX(COUNT(*)) FROM EMPLE WHERE OFICIO='EMPLEADO' GROUP BY DEPT_NO));
     
      EJER.81(ejer.6 de la pagina 169)
     -SELECT OFICIO, DEPT_NO, COUNT(*) FROM EMPLE
     GROUP BY OFICIO, DEPT_NO HAVING COUNT(*) > 2
     
      EJER.82(ejer.1 de refuerzo 5)
     -SELECT APELLIDO, SALARIO FROM EMPLE E
     WHERE SALARIO < (SELECT AVG(SALARIO) FROM EMPLE WHERE E.OFICIO=EMPLE.OFICIO)
     
      EJER.83(ejer.2 de refuerzo 5)
     -SELECT DEPT_NO, SUM(SALARIO) FROM EMPLE
     GROUP BY DEPT_NO
     HAVING SUM(SALARIO) = (SELECT MIN(SUM(SALARIO)) FROM EMPLE GROUP BY DEPT_NO)
     
      EJER.84(ejer.3 de refuerzo 5)
     -SELECT ARTICULO, PESO, CATEGORIA, COD_FABRICANTE, NIF, FECHA_VENTA, SUM(UNIDADES_VENDIDAS) FROM VENTAS GROUP BY (ARTICULO, PESO, CATEGORIA, COD_FABRICANTE, NIF, FECHA_VENTA)
     
      EJER.85(ejer.4 de refuerzo 5)
     -SELECT ARTICULO, PESO, CATEGORIA, COD_FABRICANTE, NIF, FECHA_PEDIDO, SUM(UNIDADES_PEDIDAS) FROM PEDIDOS GROUP BY (ARTICULO, PESO, CATEGORIA, COD_FABRICANTE, NIF, FECHA_PEDIDO)
     
      EJER.86(ejer.5 de refuerzo 5)
     -SELECT P.ARTICULO, P.PESO, P.CATEGORIA, P.COD_FABRICANTE, SUM(UNIDADES_PEDIDAS*PRECIO_VENTA) FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.PESO=A.PESO AND P.CATEGORIA=A.CATEGORIA AND P.COD_FABRICANTE=A.COD_FABRICANTE
     GROUP BY (P.ARTICULO, P.PESO, P.CATEGORIA, P.COD_FABRICANTE)
     
      EJER.87(ejer.6 de refuerzo 5)
     -SELECT ARTICULO, PESO, CATEGORIA, COD_FABRICANTE, SUM(UNIDADES_PEDIDAS) FROM PEDIDOS
     GROUP BY (ARTICULO, PESO, CATEGORIA, COD_FABRICANTE)
     HAVING SUM(UNIDADES_PEDIDAS)=(SELECT MAX(SUM(UNIDADES_PEDIDAS)) FROM PEDIDOS GROUP BY (ARTICULO, PESO, CATEGORIA, COD_FABRICANTE))
     
      EJER.88(ejer.7 de refuerzo 5)
     -SELECT ARTICULO, PESO, CATEGORIA, COD_FABRICANTE, SUM(UNIDADES_VENDIDAS) FROM VENTAS
     GROUP BY (ARTICULO, PESO, CATEGORIA, COD_FABRICANTE)
     HAVING SUM(UNIDADES_VENDIDAS)=(SELECT MIN(SUM(UNIDADES_VENDIDAS)) FROM VENTAS GROUP BY (ARTICULO, PESO, CATEGORIA, COD_FABRICANTE))
     EJER.89(ejer.8 de refuerzo 5)
     -SELECT P.ARTICULO, P.PESO, P.CATEGORIA, P.COD_FABRICANTE, SUM(UNIDADES_PEDIDAS*PRECIO_VENTA) FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE
     GROUP BY (P.ARTICULO, P.PESO, P.CATEGORIA, P.COD_FABRICANTE)
     HAVING SUM(UNIDADES_PEDIDAS*PRECIO_VENTA) = (
     SELECT MAX(SUM(UNIDADES_PEDIDAS*PRECIO_VENTA)) FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE
     GROUP BY (P.ARTICULO, P.PESO, P.CATEGORIA, P.COD_FABRICANTE))
     
      EJER.90(ejer.9 de refuerzo 5)
     -SELECT P.ARTICULO, P.PESO, P.CATEGORIA, P.COD_FABRICANTE, SUM(UNIDADES_PEDIDAS*PRECIO_VENTA) FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE
     GROUP BY (P.ARTICULO, P.PESO, P.CATEGORIA, P.COD_FABRICANTE)
     HAVING SUM(UNIDADES_PEDIDAS*PRECIO_VENTA) = (
     SELECT MIN(SUM(UNIDADES_PEDIDAS*PRECIO_VENTA)) FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE
     GROUP BY (P.ARTICULO, P.PESO, P.CATEGORIA, P.COD_FABRICANTE))
     
      EJER.91(ejer.10 de refuerzo 5)
     -SELECT COD_CENTRO, COUNT(*) FROM PROFESORES
     GROUP BY COD_CENTRO
     
      EJER.92(ejer.11 de refuerzo 5)
     -SELECT ESPECIALIDAD, COUNT(*) FROM PROFESORES
     GROUP BY ESPECIALIDAD
     
      EJER.93(ejer.12 de refuerzo 5)
     -SELECT COD_CENTRO, COUNT(*) FROM PROFESORES
     GROUP BY COD_CENTRO
     HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM PROFESORES GROUP BY COD_CENTRO)
     
      EJER.94(ejer.13 de refuerzo 5)
     -SELECT COD_CENTRO, COUNT(*) FROM PROFESORES
     GROUP BY COD_CENTRO
     HAVING COUNT(*) = (SELECT MIN(COUNT(*)) FROM PROFESORES GROUP BY COD_CENTRO)
     
      EJER.95(ejer.14 de refuerzo 5)
     -SELECT A.NOMBRE FROM ALUM A, NUEVOS N, ANTIGUOS AN
     WHERE A.NOMBRE=N.NOMBRE AND A.NOMBRE=AN.NOMBRE
     
      EJER.96(ejer.15 de refuerzo 5)
     -SELECT A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE, SUM(NVL(UNIDADES_PEDIDAS*PRECIO_VENTA,0)) 
     FROM PEDIDOS P, ARTICULOS A
     WHERE A.ARTICULO=P.ARTICULO(+) AND A.PESO=P.PESO(+) AND A.CATEGORIA=P.CATEGORIA(+) AND A.COD_FABRICANTE=P.COD_FABRICANTE(+)
     GROUP BY (A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE)
     
      EJER.97(ejer.16 de refuerzo 5)
     -SELECT A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE AND A.COD_FABRICANTE IN
     (SELECT COD_FABRICANTE FROM FABRICANTES WHERE PAIS='ESPAÑA')
     GROUP BY (A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE)
     
      EJER.98(ejer.17 de refuerzo 5)
     -SELECT A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE, SUM(UNIDADES_PEDIDAS*PRECIO_VENTA)FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE AND A.COD_FABRICANTE IN
     (SELECT COD_FABRICANTE FROM FABRICANTES WHERE PAIS='ESPAÑA') AND
     (UNIDADES_PEDIDAS*PRECIO_VENTA) IN (SELECT MIN(SUM(UNIDADES_PEDIDAS*PRECIO_VENTA))FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE 
     AND A.COD_FABRICANTE IN (SELECT COD_FABRICANTE FROM FABRICANTES WHERE PAIS='ESPAÑA')
     GROUP BY (A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE))
     GROUP BY (A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE)
     
      EJER.99(ejer.18 de refuerzo 5)
     -SELECT A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE, SUM(UNIDADES_PEDIDAS*PRECIO_VENTA)FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE AND A.COD_FABRICANTE IN
     (SELECT COD_FABRICANTE FROM FABRICANTES WHERE NOMBRE='GALLO') AND
     (UNIDADES_PEDIDAS*PRECIO_VENTA) > (SELECT MAX(SUM(UNIDADES_PEDIDAS*PRECIO_VENTA)) FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE 
     AND A.COD_FABRICANTE IN (SELECT COD_FABRICANTE FROM FABRICANTES WHERE NOMBRE='GALLO')
     GROUP BY (A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE))
     GROUP BY (A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE)
     
      EJER.100(ejer.19 de refuerzo 5)
     -SELECT NOMBRE FROM FABRICANTES
     WHERE COD_FABRICANTE =(SELECT A.COD_FABRICANTE FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE
     AND (UNIDADES_PEDIDAS*PRECIO_VENTA)=(SELECT MAX(SUM(UNIDADES_PEDIDAS*PRECIO_VENTA))FROM PEDIDOS P, ARTICULOS A
     WHERE P.ARTICULO=A.ARTICULO AND P.CATEGORIA=A.CATEGORIA AND P.PESO=A.PESO AND P.COD_FABRICANTE=A.COD_FABRICANTE
     GROUP BY (A.ARTICULO, A.PESO, A.CATEGORIA, A.COD_FABRICANTE)))
     
      EJER.101(ejer.20 de refuerzo 5)
     -SELECT NOMBRE FROM TIENDAS
     WHERE NIF =(SELECT NIF FROM VENTAS
     WHERE NIF IN (SELECT NIF FROM TIENDAS)
     GROUP BY NIF
     HAVING SUM(UNIDADES_VENDIDAS) =(SELECT MAX(SUM(UNIDADES_VENDIDAS)) FROM VENTAS
     WHERE NIF IN (SELECT NIF FROM TIENDAS)
     GROUP BY NIF))
     -SELECT PROVINCIA FROM TIENDAS T, PEDIDOS P
     WHERE T.NIF=P.NIF
     GROUP BY PROVINCIA
     HAVING SUM(UNIDADES_PEDIDAS) =
     (SELECT MAX(SUM(UNIDADES_PEDIDAS)) FROM PEDIDOS P, TIENDAS T
     WHERE T.NIF=P.NIF
     GROUP BY PROVINCIA)
     
      EJER.102(ejer.21 de refuerzo 5)
     -SELECT ARTICULO, PESO, CATEGORIA, COD_FABRICANTE, SUM(UNIDADES_PEDIDAS)
     FROM PEDIDOS P
     GROUP BY ARTICULO, PESO, CATEGORIA, COD_FABRICANTE
     HAVING SUM(UNIDADES_PEDIDAS) >
     (SELECT SUM(UNIDADES_VENDIDAS)
     FROM VENTAS
     WHERE ARTICULO=P.ARTICULO AND PESO=P.PESO AND CATEGORIA=P.CATEGORIA AND COD_FABRICANTE=P.COD_FABRICANTE) ORDER BY ARTICULO
     
      EJER.103(ejer.22 de refuerzo 5)
     -SELECT * FROM FABRICANTES WHERE COD_FABRICANTE IN (SELECT COD_FABRICANTE FROM PEDIDOS P
     GROUP BY COD_FABRICANTE
     HAVING COUNT(*) > (SELECT COUNT(*) FROM VENTAS
     WHERE COD_FABRICANTE=P.COD_FABRICANTE));
     
      EJER.104(ejer.23 de refuerzo 5)
     WHERE OFICIO = 'DIRECTOR'
     GROUP BY DEPT_NO)
     SELECT DEPT_NO, COUNT(EMP_NO) FROM EMPLE
     WHERE EMP_NO IN (SELECT DISTINCT DIR FROM EMPLE)
     GROUP BY DEPT_NO
     HAVING COUNT(EMP_NO) = (SELECT MAX(COUNT(EMP_NO)) FROM EMPLE
     WHERE EMP_NO IN (SELECT DISTINCT DIR FROM EMPLE)
     GROUP BY DEPT_NO)
     
      EJER.105(ejer.24 de refuerzo 5)
     -SELECT * FROM TIENDAS 
     WHERE NIF IN (SELECT NIF FROM PEDIDOS P
     GROUP BY NIF
     HAVING COUNT(*) > (SELECT COUNT(*) FROM VENTAS
     WHERE NIF=P.NIF));
     
      EJER.106(ejer.25 de refuerzo 5)
     -SELECT PROVINCIA, SUM(UNIDADES_VENDIDAS*PRECIO_VENTA) FROM TIENDAS T, VENTAS P, ARTICULOS A
     WHERE T.NIF=P.NIF AND P.ARTICULO=A.ARTICULO AND P.PESO=A.PESO AND P.CATEGORIA=A.CATEGORIA AND P.COD_FABRICANTE=A.COD_FABRICANTE
     GROUP BY PROVINCIA
     HAVING SUM(UNIDADES_VENDIDAS*PRECIO_VENTA) =
     (SELECT MAX(SUM(UNIDADES_VENDIDAS*PRECIO_VENTA)) FROM VENTAS P, TIENDAS T, ARTICULOS A
     WHERE T.NIF=P.NIF AND P.ARTICULO=A.ARTICULO AND P.PESO=A.PESO AND P.CATEGORIA=A.CATEGORIA AND P.COD_FABRICANTE=A.COD_FABRICANTE
     GROUP BY PROVINCIA)
     
      EJER.107(ejer.26 de refuerzo 5)
     -SELECT * FROM TIENDAS 
     WHERE NIF IN (SELECT NIF FROM PEDIDOS P
     GROUP BY NIF
     HAVING SUM(UNIDADES_PEDIDAS) NOT IN 
     (SELECT SUM(UNIDADES_VENDIDAS) FROM VENTAS
     WHERE NIF=P.NIF));
     
      EJER.108(ejer.5 de la pagina 165)
     -SELECT NOMBRE FROM ALUM INTERSECT (SELECT NOMBRE FROM NUEVOS UNION SELECT NOMBRE FROM ANTIGUOS);
     
     -SELECT NOMBRE FROM ALUM WHERE NOMBRE IN (SELECT NOMBRE FROM NUEVOS) OR NOMBRE IN(SELECT NOMBRE FROM ANTIGUOS);
     
      EJER.109(ejer.7 de la pagina 167)
     -SELECT NOMBRE FROM ALUM INTERSECT (SELECT NOMBRE FROM NUEVOS INTERSECT SELECT NOMBRE FROM ANTIGUOS);
     
      EJER.109(ejer.8 de la pagina 167)
     -SELECT NOMBRE FROM ALUM
     WHERE NOMBRE  IN (SELECT NOMBRE FROM NUEVOS INTERSECT SELECT NOMBRE FROM ANTIGUOS)
     
      EJER.110(ejer.9 de la pagina 167)
     -SELECT NOMBRE FROM ALUM MINUS (SELECT NOMBRE FROM NUEVOS UNION SELECT NOMBRE FROM ANTIGUOS);
     
      EJER.110(ejer.4 de la pagina 175)
     -UPDATE EMPLE 
     SET DEPT_NO=(SELECT DEPT_NO FROM EMPLE
     WHERE OFICIO='EMPLEADO'
     GROUP BY DEPT_NO
     HAVING COUNT(*)=(SELECT MAX(COUNT(*)) FROM EMPLE
     WHERE OFICIO='EMPLEADO'
     GROUP BY DEPT_NO))
     WHERE APELLIDO='SAAVEDRA';
     
      EJER.111(ejer.12 de la pagina 181)
     -UPDATE TIENDAS 
     SET (NOMBRE, DIRECCION, POBLACION, PROVINCIA, CODPOSTAL)=(SELECT NOMBRE, DIRECCION, POBLACION, PROVINCIA, CODPOSTAL FROM TIENDAS
     WHERE NIF='2222-A')
     WHERE NIF='1111-A'
     
     EJER.112(ejer.13 de la pagina 181)
     -UPDATE ARTICULOS
     SET CATEGORIA='Segunda'
     WHERE (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, PRECIO_VENTA, PRECIO_COSTO, EXISTENCIAS) IN (SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, PRECIO_VENTA, PRECIO_COSTO, EXISTENCIAS FROM ARTICULOS
     WHERE COD_FABRICANTE=(SELECT COD_FABRICANTE FROM FABRICANTES
     WHERE PAIS='ITALIA') AND CATEGORIA='Primera');
     
     EJER.113(ejer.14 de la pagina 181)
     -UPDATE PEDIDOS P
     SET UNIDADES_PEDIDAS =(SELECT EXISTENCIAS *0.2 FROM ARTICULOS
     WHERE ARTICULO=P.ARTICULO AND CATEGORIA=P.CATEGORIA AND COD_FABRICANTE=P.COD_FABRICANTE AND PESO=P.PESO)
     WHERE UNIDADES_PEDIDAS >(SELECT EXISTENCIAS FROM ARTICULOS WHERE ARTICULO=P.ARTICULO AND CATEGORIA=P.CATEGORIA AND COD_FABRICANTE=P.COD_FABRICANTE AND PESO=P.PESO)
     
      EJER.114(ejer.19 de la pagina 181)
     -UPDATE PEDIDOS
     SET UNIDADES_PEDIDAS=(UNIDADES_PEDIDAS-1)
     WHERE NIF='5555-B' AND FECHA_PEDIDO=(SELECT MAX(FECHA_PEDIDO) FROM PEDIDOS
     WHERE NIF='5555-B')
     
      EJER.115(ejer.1 de la pagina 181)
     -UPDATE CENTROS
     SET NUM_PLAZAS=(NUM_PLAZAS/2)
     WHERE COD_CENTRO IN(SELECT COD_CENTRO FROM PROFESORES
     GROUP BY COD_CENTRO
     HAVING COUNT(*)< 2);
     
      EJER.116(ejer.3 de la pagina 181)
     -INSERT INTO PROFESORES (COD_CENTRO, DNI, APELLIDOS, ESPECIALIDAD)
     (SELECT COD_CENTRO, 8790055, 'Clara Salas', 'IDIOMA'FROM PERSONAL
     WHERE FUNCION='ADMINISTRATIVO'
     GROUP BY COD_CENTRO
     HAVING COUNT(*)= 1);
     
      EJER.117(ejer.6 de la pagina 181)
     -INSERT INTO ARTICULOS (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, PRECIO_VENTA, PRECIO_COSTO, EXISTENCIAS)
     SELECT 'Fideos',COD_FABRICANTE, 1, 'Primera', '1,2', '0,80', 200 FROM FABRICANTES
     WHERE PAIS='FRANCIA';
     
     -INSERT INTO PEDIDOS(NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, FECHA_PEDIDO, UNIDADES_PEDIDAS)
     SELECT NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, SYSDATE, 5 FROM ARTICULOS, TIENDAS
     WHERE ARTICULO='Fideos' AND COD_FABRICANTE=(SELECT COD_FABRICANTE FROM FABRICANTES
     WHERE PAIS='FRANCIA');
     
      EJER.118(ejer.7 de la pagina 181)
     -INSERT INTO PEDIDOS (NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, FECHA_PEDIDO, UNIDADES_PEDIDAS)
     SELECT '1111-A', ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, SYSDATE, 20 FROM VENTAS
     GROUP BY (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA)
     HAVING COUNT(*)=(SELECT MAX(COUNT(*))FROM VENTAS
     GROUP BY(ARTICULO, COD_FABRICANTE, PESO, CATEGORIA))
     
      EJER.119(ejer.8 de la pagina 181)
     -INSERT INTO TIENDAS (NIF, NOMBRE, DIRECCION, POBLACION, PROVINCIA, CODPOSTAL)
     VALUES('6666-C', 'Terroso', 'c/murrilo 100', 'Alcobendas', 'MADRID', 12451);
     
     -INSERT INTO PEDIDOS
     SELECT '6666-C', ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, SYSDATE, 20 FROM ARTICULOS
     
      EJER.120(ejer.9 de la pagina 181)
     -INSERT INTO TIENDAS (NIF, NOMBRE, DIRECCION, POBLACION, PROVINCIA, CODPOSTAL)
     VALUES('6666-C', 'Selfi', 'C/murrilo 35', 'San Lucas', 'SEVILLA', 20845);
     
     -INSERT INTO TIENDAS (NIF, NOMBRE, DIRECCION, POBLACION, PROVINCIA, CODPOSTAL)
     VALUES('7777-A', 'Digimon', 'C/Garcia 70', 'San Mateo', 'SEVILLA', 23751);
     
     -INSERT INTO PEDIDOS (NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, FECHA_PEDIDO, UNIDADES_PEDIDAS)
     SELECT NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, SYSDATE, 30 FROM ARTICULOS, TIENDAS
     WHERE NIF IN('6666-C', '7777-A') AND COD_FABRICANTE=(SELECT COD_FABRICANTE FROM FABRICANTES WHERE NOMBRE='GALLO');
     
      EJER.121(ejer.10 de la pagina 181)
     -INSERT INTO VENTAS
     SELECT NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, SYSDATE, 10 FROM ARTICULOS, TIENDAS
     WHERE CATEGORIA ='Primera' AND NIF IN(SELECT NIF FROM TIENDAS
     WHERE PROVINCIA='TOLEDO');
     
      EJER.122(ejer.11 de la pagina 181)
     -INSERT INTO PEDIDOS
     SELECT NIF, ARTICULO, COD_FABRICANTE, PESO , CATEGORIA, SYSDATE, 10 FROM VENTAS
     WHERE NIF ='5555-B' AND(ARTICULO, COD_FABRICANTE, PESO, CATEGORIA)IN
     (SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM VENTAS
     GROUP BY (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA)
     HAVING SUM(UNIDADES_VENDIDAS) > 30);
     
     EJER.123(ejer.5 de la pagina 176)
     -DELETE ALUM
     WHERE(NOMBRE, EDAD, LOCALIDAD)IN(SELECT NOMBRE, EDAD, LOCALIDAD FROM ANTIGUOS);
     
     -DELETE DEPART
     WHERE DEPT_NO NOT IN (SELECT DEPT_NO FROM EMPLE);
     
     EJER.124(ejer.4 de la pagina 181)
     -DELETE PERSONAL
     WHERE COD_CENTRO IN(SELECT COD_CENTRO FROM CENTROS
     WHERE NUM_PLAZAS <300)
     AND
     COD_CENTRO IN (SELECT COD_CENTRO FROM PROFESORES
     GROUP BY COD_CENTRO 
     HAVING COUNT(*)< 2)
     
     EJER.125(ejer.5 de la pagina 181)
     -DELETE PROFESORES
     WHERE DNI NOT IN (SELECT DNI FROM PERSONAL
     WHERE FUNCION='PROFESOR');
     
     EJER.126(ejer.15 de la pagina 181)
     -DELETE TIENDAS
     WHERE NIF NOT IN (SELECT NIF FROM VENTAS)
     
     EJER.127(ejer.16 de la pagina 181)
     -DELETE ARTICULOS 
     WHERE (ARTICULO, PESO, CATEGORIA, COD_FABRICANTE) NOT IN (SELECT ARTICULO, PESO, CATEGORIA, COD_FABRICANTE FROM VENTAS)
     AND   (ARTICULO, PESO, CATEGORIA, COD_FABRICANTE) NOT IN (SELECT ARTICULO, PESO, CATEGORIA, COD_FABRICANTE FROM PEDIDOS)
     
     EJER.128(ejer.17 de la pagina 181)
     -DELETE ARTICULOS
     WHERE CATEGORIA='Primera' AND COD_FABRICANTE=(SELECT COD_FABRICANTE FROM FABRICANTES
     WHERE PAIS='BELGICA')
     
     EJER.129(ejer.18 de la pagina 181)
     -DELETE PEDIDOS
     WHERE NIF NOT IN (SELECT NIF FROM TIENDAS)
     
     EJER.130(ejer.1 de refuerzo 6)
     -DELETE ARTICULO
     WHERE (ARTICULO, PESO, CATEGORIA, COD_FABRICANTE)IN
     (SELECT V.ARTICULO, V.PESO, V.CATEGORIA, V.COD_FABRICANTE FROM ARTICULOS, VENTAS V
     GROUP BY (V.ARTICULO, V.PESO, V.CATEGORIA, V.COD_FABRICANTE)
     HAVING SUM(UNIDADES_VENDIDAS*PRECIO_VENTA)IN(SELECT MIN(SUM(UNIDADES_VENDIDAS*PRECIO_VENTA)) FROM ARTICULOS, VENTAS V
     GROUP BY (V.ARTICULO, V.PESO, V.CATEGORIA, V.COD_FABRICANTE)))
     
     EJER.131(ejer.2 de refuerzo 6)
     -INSERT INTO ARTICULOS (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, PRECIO_VENTA, PRECIO_COSTO, EXISTENCIAS)
     VALUES ('Macarrones', 30, 1, 'Primera', '2,25', 1, 300);
     
     -INSERT INTO PEDIDOS (NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, FECHA_PEDIDO, UNIDADES_PEDIDAS)
     SELECT NIF, A.ARTICULO, A.COD_FABRICANTE, A.PESO, A.CATEGORIA, SYSDATE, 15 FROM ARTICULOS, PEDIDOS
     WHERE ARTICULO='Macarrones' AND COD_FABRICANTE=30 AND NIF=(SELECT NIF FROM TIENDAS
     WHERE PROVINCIA='MADRID');
     
     EJER.132(ejer.3 de refuerzo 6)
     -UPDATE ARTICULOS
     SET EXISTENCIAS=(EXISTENCIAS-(
     SELECT UNIDADES_PEDIDAS FROM PEDIDOS
     WHERE ARTICULO='Macarrones' AND COD_FABRICANTE=20 AND PESO=1 AND CATEGORIA='Primera'
     AND 
     FECHA_PEDIDO=(SELECT MAX(FECHA_PEDIDO) FROM PEDIDOS
     WHERE ARTICULO='Macarrones' AND COD_FABRICANTE=20 AND PESO=1 AND CATEGORIA='Primera'
     GROUP BY (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA))))
     WHERE ARTICULO='Macarrones' AND COD_FABRICANTE=20 AND PESO=1 AND CATEGORIA='Primera'
     
     EJER.133(ejer.4 de refuerzo 6)
     -DELETE FROM ALUM
     WHERE (NOMBRE, EDAD, LOCALIDAD) IN
     (SELECT NOMBRE,EDAD, LOCALIDAD FROM ANTIGUOS MINUS SELECT NOMBRE, EDAD, LOCALIDAD FROM NUEVOS)
     
     EJER.134(ejer.5 de refuerzo 6)
     -UPDATE EMPLE
     SET SALARIO=(SALARIO+(SALARIO*0.03))
     WHERE DEPT_NO IN (SELECT DEPT_NO FROM EMPLE
     GROUP BY DEPT_NO
     HAVING SUM(SALARIO)=(SELECT MIN(SUM(SALARIO)) FROM EMPLE
     GROUP BY DEPT_NO));
     
     EJER.135(ejer.6 de refuerzo 6)
     -UPDATE ARTICULOS
     SET PRECIO_VENTA=(PRECIO_VENTA+(PRECIO_VENTA*0.05))
     WHERE(ARTICULO, COD_FABRICANTE, PESO, CATEGORIA)IN(SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM ARTICULOS
     WHERE (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA)IN(SELECT ARTICULO,COD_FABRICANTE, PESO, CATEGORIA FROM PEDIDOS
     WHERE UNIDADES_PEDIDAS IN(SELECT MAX(UNIDADES_PEDIDAS) FROM PEDIDOS)))
     
     EJER.136(ejer.7 de refuerzo 6)
     -UPDATE ARTICULOS
     SET PRECIO_VENTA=(PRECIO_VENTA-(PRECIO_VENTA*0.05))
     WHERE (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA) IN (SELECT V.ARTICULO, V.COD_FABRICANTE, V.PESO, V.CATEGORIA FROM VENTAS V, ARTICULOS
     GROUP BY (V.ARTICULO, V.COD_FABRICANTE, V.PESO, V.CATEGORIA)
     HAVING SUM(UNIDADES_VENDIDAS*PRECIO_VENTA)=(SELECT MIN(SUM(UNIDADES_VENDIDAS*PRECIO_VENTA)) FROM VENTAS V, ARTICULOS
     GROUP BY (V.ARTICULO, V.COD_FABRICANTE, V.PESO, V.CATEGORIA)))
     
     EJER.137(ejer.8 de refuerzo 6)
     -INSERT INTO PROFESORES
     SELECT COD_CENTRO, 1111111, 'Sains Barranda, Maria', 'IDIOMA' FROM CENTROS
     WHERE COD_CENTRO IN(SELECT COD_CENTRO FROM PROFESORES
     GROUP BY COD_CENTRO
     HAVING COUNT(*) IN (SELECT MIN(COUNT(*)) FROM PROFESORES
     GROUP BY COD_CENTRO))
     
     EJER.138(ejer.9 de refuerzo 6)
     -INSERT INTO TIENDAS
     VALUES('7777-C', 'Shovel kinght', 'C/rey, 20', 'Aranjuez', 'MADRID', 28300);
     
     -INSERT INTO PEDIDOS
     SELECT NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, SYSDATE, 10 FROM ARTICULOS, TIENDAS
     WHERE COD_FABRICANTE IN(SELECT COD_FABRICANTE FROM FABRICANTES
     WHERE PAIS='ESPAÑA') AND NIF= '7777-C';
     
     EJER.139(ejer.10 de refuerzo 6)
     -UPDATE EMPLE E
     SET SALARIO =(SELECT TRUNC(AVG(SALARIO)) FROM EMPLE 
     WHERE EMPLE.DEPT_NO=E.DEPT_NO)
     WHERE SALARIO <
     (SELECT TRUNC(AVG(SALARIO)) FROM EMPLE
     WHERE DEPT_NO=E.DEPT_NO))
     
     EJER.140(ejer.11 de refuerzo 6)
     -UPDATE PEDIDOS
     SET UNIDADES_PEDIDAS=(UNIDADES_PEDIDAS-1)
     WHERE (NIF, FECHA_PEDIDO) IN (SELECT NIF , MAX(FECHA_PEDIDO) FROM PEDIDOS
     GROUP BY NIF)
     
     EJER.141(ejer.12 de refuerzo 6)
     -INSERT INTO PROFESORES
     SELECT COD_CENTRO, 5555555, 'Barbachon Rodriguez, Fernando', 'IDIOMA' FROM PERSONAL
     GROUP BY COD_CENTRO
     HAVING COUNT(*) IN (SELECT MAX(COUNT(*)) FROM PERSONAL
     GROUP BY COD_CENTRO)
     
     -INSERT INTO PROFESORES
     SELECT COD_CENTRO, 7777777, 'Barbachon Rodriguez, Pepe', 'IDIOMA' FROM PERSONAL
     GROUP BY COD_CENTRO
     HAVING COUNT(*) IN (SELECT MAX(COUNT(*)) FROM PERSONAL
     GROUP BY COD_CENTRO)
     
     EJER.142(ejer.13 de refuerzo 6)
     -INSERT INTO PROFESORES
     SELECT COD_CENTRO, 4444444, 'Fernandez Garcia, Españoleto', 'DERECHO' FROM CENTROS
     WHERE NUM_PLAZAS=(SELECT MAX(NUM_PLAZAS) FROM CENTROS)
     
     EJER.143(ejer.14 de refuerzo 6)
     -INSERT INTO ARTICULOS (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, PRECIO_VENTA, PRECIO_COSTO, EXISTENCIAS)
     VALUES ('Gba', '25', '1', 'Segunda', 1, 1, 300)
     
     -INSERT INTO PEDIDOS
     SELECT NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, SYSDATE, 15 FROM ARTICULOS, TIENDAS
     WHERE NIF IN (SELECT NIF FROM TIENDAS 
     WHERE PROVINCIA='MADRID')
     AND
     (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA)IN(SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM ARTICULOS
     WHERE ARTICULO IN 'Gba')
     
     -INSERT INTO VENTAS
     SELECT NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, SYSDATE, 15 FROM ARTICULOS, TIENDAS
     WHERE NIF IN (SELECT NIF FROM TIENDAS 
     WHERE PROVINCIA='MADRID')
     AND
     (ARTICULO, COD_FABRICANTE, PESO, CATEGORIA)IN(SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM ARTICULOS
     WHERE ARTICULO IN 'Gba')
     
     EJER.144(ejer.15 de refuerzo 6)
     -UPDATE ARTICULOS 
     SET EXISTENCIAS=(EXISTENCIAS-(SELECT SUM(UNIDADES_PEDIDAS) FROM PEDIDOS
     WHERE ARTICULO IN 'Gba'))
     WHERE ARTICULO IN 'Gba'
     
     EJER.145(ejer.4 de pagina 190)
     -CREATE TABLE EJEMPLO2
     (
     DNI VARCHAR2(10),
     NOMBRE VARCHAR2(15) DEFAULT 'no literal',
     USUARIO VARCHAR2(15) DEFAULT UID
     );
     
     EJER.146(ejer.5 de pagina 199) (Prueba de constraint en el insert tiene que dar error)
     -CREATE TABLE EJEMPLO3
     (
     DNI VARCHAR2(10) NOT NULL,
     NOMBRE VARCHAR2(30) NOT NULL,
     EDAD NUMBER(2),
     CURSO NUMBER,
     CONSTRAINT CLAVE_P PRIMARY KEY(DNI),
     CONSTRAINT COMP_EDAD CHECK (EDAD BETWEEN 5 AND 20),
     CONSTRAINT NOMBRE_MAYUS CHECK (NOMBRE = UPPER(NOMBRE)),
     CONSTRAINT COMP_CURSO CHECK (CURSO IN(1, 2, 3))
     );
     
     EJER.147(ejer.6 de pagina 200)
     CREATE TABLE FABRICANTE07(
     COD_FABRICANTE NUMBER(3),
     NOMBRE VARCHAR2(15),
     PAIS VARCHAR2(15),
     CONSTRAINT PK_INVALIDA PRIMARY KEY(COD_FABRICANTE),
     CONSTRAINT NOMBRE_MAYUSCULA CHECK(NOMBRE=UPPER(NOMBRE)),
     CONSTRAINT PAIS_MAYUSCULA CHECK(PAIS=UPPER(PAIS)) 
     );
     
     -CREATE TABLE ARTICULOS07(
     ARTICULO VARCHAR2(20),
     COD_FABRICANTE NUMBER(3),
     PESO NUMBER(3),
     CATEGORIA VARCHAR2(10),
     PRECIO_VENTA NUMBER(6,2),
     PRECIO_COSTO NUMBER(6,2),
     EXISTENCIAS NUMBER (5),
     CONSTRAINT CLAVE_PK PRIMARY KEY(ARTICULO,COD_FABRICANTE, PESO, CATEGORIA),
     CONSTRAINT CLAVE_AK FOREIGN KEY(COD_FABRICANTE) REFERENCES FABRICANTES07 ON DELETE CASCADE,
     CONSTRAINT precio_venta_0 CHECK(PRECIO_VENTA>0),
     CONSTRAINT precio_costo_0 CHECK(PRECIO_COSTO>0),
     CONSTRAINT categoria_invalida CHECK(CATEGORIA IN('primera', 'segunda', 'tercera')));
     
     EJER.148 (ejer.1 de refuerzo 7)
     -DROP TABLE ARTICULOS;
     
     -DROP TABLE ARTICULOS07;
     
      EJER.149(ejer.2 de refuerzo 7)
      -CREATE TABLE GENEROS_MUSICALES(
     GENERO VARCHAR2(15),
     DECADA_ORO NUMBER(4),
     INTERES NUMBER (2),
     CONSTRAINT CLAVE_PRIMARIA_INVALIDA PRIMARY KEY(GENERO, DECADA_ORO),
     CONSTRAINT Entre_0 CHECK(INTERES > 0),
     CONSTRAINT ENtre_10 CHECK(INTERES <11)
     );
     
     -CREATE TABLE AUTORES07(
     NOMBRE VARCHAR2(15),
     AÑO_NACIMIENTO NUMBER(4),
     GRUPO VARCHAR2(15),
     CANCION_EXITO VARCHAR2(40),
     POSICION NUMBER(3),
     CONSTRAINT CLAVE_PK_INVALIDA_AUTORES07 PRIMARY KEY(NOMBRE, AÑO_NACIMIENTO, GRUPO)
     );
     
     CREATE TABLE GEN_AUT(
     CODIGO NUMBER(3),
     NOMBRE VARCHAR2(15),
     AÑO_NACIMIENTO NUMBER(4),
     GRUPO VARCHAR2(15),
     GENERO VARCHAR2(15),
     DECADA_ORO NUMBER(4),
     CONSTRAINT CLAVE_PK_INVALIDA_GENAUTOR PRIMARY KEY(CODIGO),
     CONSTRAINT CLAVE_AK_1_INVALIDA_GEN_AUT FOREIGN KEY(NOMBRE, AÑO_NACIMIENTO, GRUPO) REFERENCES AUTORES07 ON DELETE CASCADE,
     CONSTRAINT CLAVE_AK_2_INVALIDA_GENA_UT FOREIGN KEY(GENERO, DECADA_ORO) REFERENCES GENEROS_MUSICALES ON DELETE CASCADE
     )
     
     EJER.149(ejer.2 de pagina 215)
     
     EJER.150()
     CREATE OR REPLACE PROCEDURE 
     AS
     BEGIN 
      DBMS_OUTPUT.PUT_LINE('HOLA');
     END;
     
     EJER.151()
     DECLARE
      v_num NUMBER;
     BEGIN
      SELECT COUNT(*) v_num
      FROM productos;
      DBMS_OUTPUT.PUT LINE(v_num);
     END;
     /
     EJER.152(ejercicios.)
     -CREATE OR REPLACE PROCEDURE v_depart (num_dept NUMBER)
     AS
      v_dnombre VARCHAR2(14);
      v_localidad VARCHAR2(14);
      v_count NUMBER(3);
     BEGIN
      SELECT DNOMBRE, LOC, COUNT(*) INTO v_dnombre, v_localidad, v_count
      FROM DEPART D, EMPLE E 
      WHERE E.DEPT_NO=D.DEPT_NO AND D.DEPT_NO=num_dept
      GROUP BY DNOMBRE, LOC;
      DBMS_OUTPUT.PUT_LINE('Los datos son: '||v_dnombre||' '||v_localidad||' Numero de empleados: '||v_count);
     EXCEPTION
      WHEN NO_DATA_FOUND THEN
      DBMS_OUTPUT.PUT_LINE('Ninguna fila encontrada');
      WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('ERROR');
     END; 
     /
     
     EJER.153(ejercicios.)
     -CREATE OR REPLACE PROCEDURE EJERCICIO_2 (num_dept NUMBER)
     AS
     v_empleado NUMBER(2);
     v_vendedor NUMBER(2);
     V_director NUMBER(2);
     
     BEGIN
     
     SELECT COUNT(*) INTO v_empleado FROM EMPLE 
     WHERE OFICIO='EMPLEADO' AND DEPT_NO=num_dept;
     
     SELECT COUNT(*) INTO v_vendedor FROM EMPLE
     WHERE OFICIO='VENDEDOR' AND DEPT_NO=num_dept;
     
     SELECT COUNT(*) INTO v_director FROM EMPLE
     WHERE OFICIO='DIRECTOR' AND DEPT_NO=num_dept;
     
     DBMS_OUTPUT.PUT_LINE('El numero de empleados es: '||v_empleado);
     DBMS_OUTPUT.PUT_LINE('El numero de vendedor es: '||v_vendedor);
     DBMS_OUTPUT.PUT_LINE('El numero de director es: '||V_director);
     
     END EJERCICIO_2;
     
     EJER.154(ejercicios.)
     -CREATE OR REPLACE PROCEDURE EJERCICIO_3 (n_fabricante VARCHAR2)
     AS
     
     v_cod NUMBER(2);
     V_num_ped NUMBER(3);
     v_facturacion NUMBER(12,4);
     
     BEGIN
     
     SELECT COD_FABRICANTE INTO v_cod FROM FABRICANTES WHERE NOMBRE=n_fabricante;
     
     SELECT COUNT(*) INTO v_num_ped FROM PEDIDOS WHERE COD_FABRICANTE=v_cod;
     
     SELECT SUM(PRECIO_VENTA*UNIDADES_PEDIDAS) INTO v_facturacion FROM FABRICANTES F, ARTICULOS A, PEDIDOS P
     WHERE A.ARTICULO=P.ARTICULO AND A.PESO=P.PESO AND A.CATEGORIA=P.CATEGORIA AND A.COD_FABRICANTE=P.COD_FABRICANTE AND F.COD_FABRICANTE=v_cod GROUP BY F.COD_FABRICANTE;
     
     DBMS_OUTPUT.PUT_LINE('El fabricante '||n_fabricante||' facturo '||v_facturacion||' euros con un total de '||v_num_ped||'pedidos');
     
     EXCEPTION
     
     WHEN NO_DATA_FOUND THEN
     DBMS_OUTPUT.PUT_LINE('Ningun fabricante encontrado');
     
     END EJERCICIO_3;
     
     EJER.155(ejercicios.)
     
     CREATE OR REPLACE PROCEDURE EJERCICIO_4 (v_cod NUMBER)
     AS
     
     v_profesores NUMBER(2);
     v_personal NUMBER(2);
     
     BEGIN
     
     SELECT COUNT(*) INTO v_profesores FROM PERSONAL
     WHERE COD_CENTRO=v_cod AND FUNCION='PROFESOR';
     
     SELECT COUNT(*) INTO v_personal FROM PERSONAL
     WHERE COD_CENTRO=v_cod;
     
     DBMS_OUTPUT.PUT_LINE('El centro con codigo '||v_cod||' posee este numero de profesores '||v_profesores||' y este numero de personal '|| v_personal);
     
     EXCEPTION
     
     WHEN NO_DATA_FOUND THEN
     DBMS_OUTPUT.PUT_LINE('No se encontro resultado');
     
     END EJERCICIO_4;
     
     EJER.156(ejercicios.)
     CREATE TABLE FABRICANTES_08(
     
     COD_FABRICANTE NUMBER(3),
     NOMBRE VARCHAR2(15),
     PAIS VARCHAR2(15),
     FACTURACION NUMBER(12,4),
     NUMERO_UNIDADES NUMBER(10),
     CONSTRAINT CLAVE_PK PRIMARY KEY (COD_FABRICANTE));
     
     CREATE OR REPLACE PROCEDURE EJERCICIO_5 (N VARCHAR2, ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2, UNI NUMBER)
     AS
     
     v_fact NUMBER(6,2);
     v_uni NUMBER (4);
     
     BEGIN
     INSERT INTO PEDIDOS VALUES (N, ART, COD, PES, CAT, SYSDATE, UNI);
     
     SELECT SUM(UNIDADES_PEDIDAS*PRECIO_VENTA) INTO v_fact
     FROM ARTICULOS A, PEDIDOS P
     WHERE A.ARTICULO=P.ARTICULO AND A.COD_FABRICANTE=P.COD_FABRICANTE AND A.PESO=P.PESO AND A.CATEGORIA=P.CATEGORIA AND P.COD_FABRICANTE=COD
     GROUP BY P.COD_FABRICANTE;
     
     SELECT SUM(UNIDADES_PEDIDAS) INTO v_uni FROM PEDIDOS WHERE COD_FABRICANTE=COD GROUP BY COD_FABRICANTE;
     
     UPDATE FABRICANTES_08 R
     SET FACTURACION= (SELECT SUM(UNIDADES_PEDIDAS * PRECIO_VENTA) FROM PEDIDOS P, ARTICULOS A WHERE A.ARTICULO = P.ARTICULO AND A.COD_FABRICANTE = P.COD_FABRICANTE AND A.PESO = P.PESO AND A.CATEGORIA = P.CATEGORIA AND P.COD_FABRICANTE = R.COD_FABRICANTE);
     
     EXCEPTION
     WHEN NO_DATA_FOUND THEN
     DBMS_OUTPUT.PUT_LINE('No hay datos');
     
     WHEN OTHERS THEN
     DBMS_OUTPUT.PUT_LINE('Error');
     
     END EJERCICIO_5;
     
     EJER.157(ejercicios.)
     CREATE OR REPLACE PROCEDURE EJERCICIO_6(ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2, PRE_VEN NUMBER, PRE_COS NUMBER, EXIS NUMBER)
     AS
     v_exis_art NUMBER(2);
     v_exis_cod NUMBER(2);
     sum_ped NUMBER(4);
     sum_ven NUMBER(4);
     BEGIN
     
     SELECT COUNT(*)INTO v_exis_art FROM ARTICULOS
     WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     
     SELECT COUNT(*) INTO v_exis_cod FROM FABRICANTES
     WHERE COD_FABRICANTE=COD;
     
     IF (v_exis_art = 0 AND v_exis_cod > 0) THEN 
     
     INSERT INTO ARTICULOS
     VALUES(ART, COD, PES, CAT, PRE_VEN, PRE_COS, EXIS);
     
     INSERT INTO PEDIDOS
     SELECT NIF, ART, COD, PES, CAT, SYSDATE, 5 FROM TIENDAS;
     
     INSERT INTO VENTAS
     SELECT NIF, ART, COD, PES, CAT, SYSDATE, 5 FROM TIENDAS;
     
     END IF;
     
     SELECT SUM(UNIDADES_VENDIDAS)INTO sum_ven FROM VENTAS
     WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     
     SELECT SUM(UNIDADES_PEDIDAS) INTO sum_ped FROM PEDIDOS
     WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     
     DBMS_OUTPUT.PUT_LINE('El numero total de unidades vendidas del articulo es: '||sum_ven);
     DBMS_OUTPUT.PUT_LINE('El numero total de unidades pedidas del articulo es: '||sum_ped);
     
     EXCEPTION
     
     WHEN OTHERS THEN
     DBMS_OUTPUT.PUT_LINE('ERROR');
     
     END EJERCICIO_6;
     
     EJER.158(ejercicios.)
     CREATE OR REPLACE PROCEDURE EJERCICIO_7(EMP NUMBER, APE VARCHAR2, OFI VARCHAR2, DR NUMBER, FEC_ALT DATE, D_N NUMBER, COM NUMBER DEFAULT 0)
     AS
     v_num NUMBER(3);
     v_salario NUMBER (6,2);
     
      BEGIN
     
     SELECT COUNT(*) INTO v_num FROM EMPLE
     WHERE DEPT_NO=D_N;
     SELECT * FROM EMPLE;
     SELECT TRUNC(ABS(SUM(SALARIO))+0.03*ABS(SUM(SALARIO))) INTO v_salario FROM EMPLE
     WHERE DEPT_NO=D_N
     GROUP BY DEPT_NO;
     
     IF (v_salario>0 AND v_num>0 AND COM>=0)THEN
     INSERT INTO EMPLE
     VALUES(EMP, APE, OFI, DR, FEC_ALT, v_salario, COM, D_N );
     
     ELSE
     DBMS_OUTPUT.PUT_LINE('no se ha insertado');
     
     END IF;
     
     EXCEPTION
     WHEN OTHERS THEN
     DBMS_OUTPUT.PUT_LINE('error');
     
     END EJERCICIO_7;
     
     EJER.159(ejercicios.)
     CREATE OR REPLACE PROCEDURE Ejercicio_1_9(num_1 NUMBER, num_2 NUMBER)
     AS
     v_total NUMBER(6);
     BEGIN
     v_total :=(num_1+num_2);
     DBMS_OUTPUT.PUT_LINE('El resultado es: '||v_total);
     END Ejercicio_1_9;
     
     EJER.160(ejercicios.)
     
     CREATE OR REPLACE FUNCTION Ejercicio_4_9(fecha DATE)
     RETURN VARCHAR2
     AS
     v_fecha NUMBER (10);
     BEGIN
     SELECT TO_CHAR(fecha, 'yyyy') INTO v_fecha FROM DUAL;
     RETURN v_fecha;
     END Ejercicio_4_9;
     
     EJER.161(ejercicios.)
     CREATE OR REPLACE FUNCTION Ejercicio_4_9(fecha DATE)
     RETURN VARCHAR2
     AS
     v_fecha NUMBER (10);
     BEGIN
     SELECT TO_CHAR(fecha, 'yyyy') INTO v_fecha FROM DUAL;
     RETURN v_fecha;
     END Ejercicio_4_9;
     
     BEGIN
     DBMS_OUTPUT.PUT_LINE(Ejercicio_4_9('10/12/1200'));
     END;
     
     EJER.162(ejercicios.)
     CREATE OR REPLACE PROCEDURE ejercicios_5_9(fecha DATE)
     AS
     v_fecha NUMBER(4);
     BEGIN
     v_fecha := (Ejercicio_4_9(fecha) -2);
     DBMS_OUTPUT.PUT_LINE('El año es: '||v_fecha);
     END ejercicios_5_9;
     
     EJER.163(ejercicios.)
     CREATE OR REPLACE FUNCTION ejercicio_6_9(fecha_1 DATE, fecha_2 DATE)
     RETURN NUMBER
     AS
     v_num_a NUMBER(8);
     BEGIN
     v_num_a := TRUNC(ABS(fecha_1-fecha_2)/365.25);
     RETURN v_num_a;
     END ejercicio_6_9;
     
     BEGIN
     DBMS_OUTPUT.PUT_LINE(ejercicio_6_9('10/12/2015', '30/7/1998'));
     END;
     
     EJER.164(ejercicios.)
     CREATE OR REPLACE FUNCTION ejercicio_7_9(fecha_1 DATE, fecha_2 DATE)
     RETURN NUMBER
     AS
     v_tri NUMBER(4);
     BEGIN 
     v_tri :=TRUNC(ejercicio_6_9(fecha_1, fecha_2)/3);
     DBMS_OUTPUT.PUT_LINE('El numero de trienios es: '||v_tri);
     RETURN v_tri;
     END ejercicio_7_9;
     
     BEGIN
     DBMS_OUTPUT.PUT_LINE(ejercicio_7_9('10/12/2015', '30/7/1998'));
     END;
     
     EJER.165(ejercicios.)
     CREATE OR REPLACE PROCEDURE EJERCICIO_8_9 (num1 NUMBER DEFAULT 0, num2 NUMBER DEFAULT 0, num3 NUMBER DEFAULT 0, num4 NUMBER DEFAULT 0 , num5 NUMBER DEFAULT 0)
     AS
     v_total NUMBER(10);
     BEGIN
     v_total :=(num1+num2+num3+num4+num5);
      DBMS_OUTPUT.PUT_LINE('El resultado es: '||v_total);
     END EJERCICIO_8_9;
     
     EJER.166(ejercicios)
     CREATE OR REPLACE PROCEDURE ref_1_9(v_cod NUMBER, v_dni NUMBER, v_apellidos VARCHAR2, v_especialidad VARCHAR2)
     AS
     v_count_cod NUMBER(2);
     v_count_dni NUMBER(2);
     BEGIN
     SELECT COUNT(*) INTO v_count_cod FROM CENTROS 
     WHERE COD_CENTRO=v_cod;
     SELECT COUNT(*) INTO v_count_dni FROM PROFESORES
     WHERE DNI=v_dni;
     IF (v_count_cod = 0) THEN
      DBMS_OUTPUT.PUT_LINE('No existe el centro con ese codigo.');
     ELSIF(v_count_dni > 0) THEN
      DBMS_OUTPUT.PUT_LINE('Ese dni ya esta registrado');
     ELSE
     INSERT INTO PROFESORES
     VALUES(v_cod, v_dni, v_apellidos, v_especialidad);
     EXCEPTION
     WHEN OTHERS THEN
      DBMS_OUTPUT.PUT_LINE('Error');
     END ref_1_9;
     
     EJER.167(ejerciccios_refuerzo_9)
     
     -CREATE OR REPLACE PROCEDURE EJER_9 (ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2)
      AS
       PROCEDURE FACT(ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2)
        AS
         V_FACT NUMBER(7,2);
        BEGIN
         SELECT SUM(UNIDADES_PEDIDAS*PRECIO_VENTA) INTO V_FACT FROM ARTICULOS A, PEDIDOS P WHERE A.ARTICULO=P.ARTICULO AND
         A.COD_FABRICANTE=P.COD_FABRICANTE AND A.PESO=P.PESO AND A.CATEGORIA=P.CATEGORIA;
         DBMS_OUTPUT.PUT_LINE(V_FACT);
        END FACT;
       PROCEDURE NUM_PED(ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2)
        AS
         V_NUM_PED NUMBER(2);
        BEGIN
         SELECT COUNT(*) INTO V_NUM_PED FROM PEDIDOS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
         DBMS_OUTPUT.PUT_LINE(V_NUM_PED);
        END NUM_PED;
      BEGIN 
       FACT(ART, COD, PES, CAT);
       NUM_PED(ART, COD, PES, CAT);
       
     END EJER_9;
     
     EJER.168(ejerciccios_refuerzo_9)
     CREATE OR REPLACE PROCEDURE EJER_10(DEPT NUMBER)
     AS
     
     V_GAST NUMBER(10);
     V_NUM_EMPLE NUMBER(10);
     
     FUNCTION NUM_EMPLE(DEPT NUMBER)
     RETURN NUMBER
     AS
      V_NUM_EMP NUMBER(3);
     BEGIN
     SELECT COUNT(*) INTO V_NUM_EMP FROM EMPLE
     WHERE DEPT_NO=DEPT;
     RETURN V_NUM_EMP;
     END NUM_EMPLE;
     
     FUNCTION GAST(DEPT NUMBER)
     RETURN NUMBER
     AS
     V_GAST NUMBER(10,4);
     BEGIN
     SELECT SUM(SALARIO) INTO V_GAST FROM EMPLE
     WHERE DEPT_NO=DEPT;
     DBMS_OUTPUT.PUT_LINE(V_GAST);
     RETURN V_GAST;
     END GAST;
     
     BEGIN
     
     V_NUM_EMPLE :=NUM_EMPLE(DEPT);
     V_GAST :=GAST(DEPT);
     DBMS_OUTPUT.PUT_LINE(V_NUM_EMPLE);
     DBMS_OUTPUT.PUT_LINE(V_GAST);
     
     END EJER_10;
     
     EJER.169
     
     CREATE OR REPLACE PROCEDURE EJERCICIO_1_10
     AS
     CURSOR c1 IS SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM ARTICULOS;
     V_REG c1%ROWTYPE;
     BEGIN
     OPEN c1;
     FETCH c1 INTO V_REG;
     WHILE c1%FOUND LOOP
     DBMS_OUTPUT.PUT_LINE (RPAD(V_REG.ARTICULO,20) ||' '||RPAD(V_REG.COD_FABRICANTE,5) ||' '|| RPAD(V_REG.PESO,5) ||' '|| RPAD(V_REG.CATEGORIA,15));
     FETCH c1 INTO V_REG;
     END LOOP;
     CLOSE c1;
     END EJERCICIO_1_10;
     
     EJER.170
     
     CREATE OR REPLACE PROCEDURE EJERCICIO_2_10 (dep NUMBER)
     AS
     
     V_DEP NUMBER(3);
     CURSOR cur IS SELECT DNOMBRE, LOC  FROM DEPART WHERE DEPT_NO=V_DEP;
     V_REG cur%ROWTYPE;
     
     BEGIN
     
     V_DEP :=dep;
     
     OPEN cur;
      FETCH cur INTO V_REG;
      WHILE cur%FOUND LOOP
       DBMS_OUTPUT.PUT_LINE (RPAD(V_REG.DNOMBRE,20)||RPAD(V_DEP,5)||RPAD(V_REG.LOC,20));
       FETCH cur INTO V_REG;
      END LOOP;
     CLOSE cur;
     
     END EJERCICIO_2_10;
     
     EJER.171
     
     CREATE OR REPLACE PROCEDURE EJERCICIO_3_10
     AS
      CURSOR C2 IS SELECT APELLIDO, FECHA_ALT FROM EMPLE ORDER BY APELLIDO;
     V_REG C2%ROWTYPE;
     
     BEGIN
     OPEN C2;
      FETCH C2 INTO V_REG;
      WHILE C2%FOUND LOOP
       DBMS_OUTPUT.PUT_LINE(RPAD(V_REG.APELLIDO,20)||RPAD(V_REG.FECHA_ALT,10));
       FETCH C2 INTO V_REG;
     END LOOP;
     CLOSE C2;
     
     END EJERCICIO_3_10;
     
     EJER.172
     
     CREATE OR REPLACE PROCEDURE EJERCICIO_4_10
     AS
     CURSOR C1 IS SELECT COUNT(APELLIDO) NUM_EMPLE, DNOMBRE FROM EMPLE E, DEPART D WHERE D.DEPT_NO=E.DEPT_NO GROUP BY DNOMBRE;
     V_REG C1%ROWTYPE;
     
     BEGIN
     OPEN C1;
     FETCH C1 INTO V_REG;
     WHILE C1%FOUND LOOP
      DBMS_OUTPUT.PUT_LINE(RPAD(V_REG.DNOMBRE, 20)||V_REG.NUM_EMPLE);
      FETCH C1 INTO V_REG;
     END LOOP;
     CLOSE C1;
     END EJERCICIO_4_10;
     
     EJER.173
     CREATE OR REPLACE PROCEDURE EJERCICIO_3_10
     AS
     CURSOR c3 IS SELECT APELLIDO, SALARIO FROM EMPLE ORDER BY SALARIO DESC;
     V_REG c3%ROWTYPE;
     V_SUMA NUMBER(1);
     
     BEGIN
     
     V_SUMA := 0;
     
     FOR V_REG IN c3 LOOP
      DBMS_OUTPUT.PUT_LINE(V_REG.APELLIDO||V_REG.SALARIO);
      V_SUMA := V_SUMA+1;
     EXIT WHEN V_SUMA=5;
     END LOOP;
     
     END EJERCICIO_3_10;
     
     EJER.174
     CREATE OR REPLACE PROCEDURE EJERCICIO_4_10
     AS
     CURSOR c4 IS SELECT * FROM EMPLE ORDER BY OFICIO, SALARIO;
     
     V_SUMA NUMBER(2);
     V_OFICIO VARCHAR2(30);
     
     BEGIN
     V_SUMA :=1;
     V_OFICIO := 'HOSTIA CON LA MANO ABIERTA';
     FOR V_REG IN C4 LOOP
      
      IF(V_OFICIO !=V_REG.OFICIO ) THEN
        V_OFICIO:= V_REG.OFICIO;
        V_SUMA :=1;
      END IF;
     
      IF (V_SUMA <=2) THEN
      DBMS_OUTPUT.PUT_LINE(RPAD(V_REG.APELLIDO,20)||RPAD(V_REG.OFICIO,20)||V_REG.SALARIO);
      END IF;
     V_SUMA :=V_SUMA+1;
     END LOOP;
     
     END EJERCICIO_4_10;
     
     EJER.175
     CREATE OR REPLACE PROCEDURE EJERCICIO_5_10 (dnom VARCHAR2, loca VARCHAR2)
     AS
     v_dept NUMBER(3);
     v_dept_no NUMBER(3);
     v_count NUMBER(2);
     BEGIN
     
     SELECT MAX(DEPT_NO) INTO v_dept FROM DEPART;
     SELECT COUNT(*) INTO v_count FROM DEPART WHERE DNOMBRE=dnom;
     
     v_dept_no := v_dept+10;
     
     IF (v_count=0) THEN
     
     INSERT INTO DEPART VALUES(v_dept_no, dnom, loca);
     DBMS_OUTPUT.PUT_LINE('INSERTADO');
     
     ELSE
     
     DBMS_OUTPUT.PUT_LINE('ya existe el nombre');
     
     END IF;
     
     END EJERCICIO_5_10;
     
     EJER.176
     CREATE OR REPLACE PROCEDURE EJERCICIO_6_10(p_dept NUMBER, import NUMBER, por NUMBER)
     AS
     CURSOR u1 IS SELECT * FROM EMPLE WHERE DEPT_NO=p_dept FOR UPDATE;
     V_REG U1%ROWTYPE;
     v_por NUMBER(10);
     v_aumento NUMBER(10);
     BEGIN
     OPEN u1;
     FETCH u1 INTO V_REG;
     WHILE U1%FOUND LOOP
      v_por := (V_REG.SALARIO/100)*por;
     
     IF (v_por > import) THEN
      v_aumento := v_por;
     ELSE
      v_aumento := import;
     END IF;
     
     
     UPDATE EMPLE SET SALARIO=SALARIO + v_aumento WHERE CURRENT OF u1; --(actual)
     DBMS_OUTPUT.PUT_LINE('ACTUALIZADO');
     FETCH u1 INTO V_REG;
     
     END LOOP;
     
     EXCEPTION
     WHEN NO_DATA_FOUND THEN
     DBMS_OUTPUT.PUT_LINE('No se encontraron datos');
     
     WHEN OTHERS THEN
     DBMS_OUTPUT.PUT_LINE('Fallo catrastofico');
     
     END EJERCICIO_6_10;
     
     EJER.177
     CREATE OR REPLACE PROCEDURE EJERCICIO_8_10
     AS
     
     CURSOR C1 IS SELECT * FROM EMPLE;
     
     V_TRIENIO NUMBER(20);
     V_ANTI NUMBER(20);
     V_COUNT NUMBER(20);
     V_RES NUMBER(20);
     V_COMISION NUMBER(20);
     V_TOTAL NUMBER(20);
     
     BEGIN
     FOR V_REG IN C1 LOOP
     
     SELECT TRUNC(((MONTHS_BETWEEN(SYSDATE, FECHA_ALT)/12)/3)) INTO V_TRIENIO FROM EMPLE WHERE EMP_NO=V_REG.EMP_NO;
     SELECT COUNT(*) INTO V_COUNT FROM EMPLE WHERE DIR=V_REG.EMP_NO;
     SELECT NVL(COMISION,0) INTO V_COMISION FROM EMPLE WHERE EMP_NO=V_REG.EMP_NO;
     
     V_ANTI := V_TRIENIO*50;
     V_RES :=V_COUNT*100;
     V_TOTAL := V_REG.SALARIO+V_ANTI+V_RES+V_COMISION;
     
     DBMS_OUTPUT.PUT_LINE('*****************************************');
     DBMS_OUTPUT.PUT_LINE(RPAD('Liquidacion del empleado',30)||V_REG.APELLIDO);
     DBMS_OUTPUT.PUT_LINE(RPAD('Dpto',30)||V_REG.DEPT_NO);
     DBMS_OUTPUT.PUT_LINE(RPAD('Oficio',30)||V_REG.OFICIO);
     DBMS_OUTPUT.PUT_LINE(RPAD('Salario',30)||V_REG.SALARIO);
     DBMS_OUTPUT.PUT_LINE(RPAD('Trienios',30)||V_ANTI);
     DBMS_OUTPUT.PUT_LINE(RPAD('Comp.responsabilidad',30)||V_RES);
     DBMS_OUTPUT.PUT_LINE(RPAD('Comision',30)||V_COMISION);
     DBMS_OUTPUT.PUT_LINE('*****************************************');
     DBMS_OUTPUT.PUT_LINE(RPAD('Total',30)||V_TOTAL);
     DBMS_OUTPUT.PUT_LINE('*****************************************');
     
     END LOOP;
     END EJERCICIO_8_10;
     
     EJER.178
     -CREATE TABLE EMPLE_H
     AS
     SELECT * FROM EMPLE;
     
     DELETE FROM EMPLE_H;
     
     CREATE OR REPLACE PROCEDURE EJERCICIO_1_R (P_DEPT NUMBER)
     AS
     CURSOR C1 IS SELECT * FROM EMPLE WHERE DEPT_NO=P_DEPT;
     BEGIN
     FOR V_REG IN C1 LOOP
     INSERT INTO EMPLE_H VALUES(V_REG.EMP_NO, V_REG.APELLIDO, V_REG.OFICIO, V_REG.DIR, V_REG.FECHA_ALT, V_REG.SALARIO, V_REG.COMISION, V_REG.DEPT_NO);
     DBMS_OUTPUT.PUT_LINE('Insertado');
     DELETE FROM EMPLE WHERE EMP_NO=V_REG.EMP_NO;
     DBMS_OUTPUT.PUT_LINE('Eliminado');
     END LOOP;
     
     END EJERCICIO_1_R;
     
     EJER.179
     
     CREATE OR REPLACE PROCEDURE EJERCICIO_2_R (DNOM VARCHAR2)
     AS
     CURSOR C1 IS SELECT * FROM EMPLE WHERE DEPT_NO=(SELECT DEPT_NO FROM DEPART WHERE DNOMBRE=DNOM) FOR UPDATE;
     V_AVG NUMBER(20);
     V_VEN NUMBER(20);
     
     BEGIN
     SELECT AVG(SALARIO) INTO V_AVG FROM EMPLE WHERE DEPT_NO=(SELECT DEPT_NO FROM DEPART WHERE DNOMBRE=DNOM);
     SELECT DEPT_NO INTO V_VEN FROM DEPART WHERE DNOMBRE='VENTAS';
     
     FOR V_REG IN C1 LOOP
     
     IF (V_REG.SALARIO < V_AVG) THEN
     INSERT INTO EMPLE_H SELECT * FROM EMPLE WHERE EMP_NO=V_REG.EMP_NO;
     UPDATE EMPLE SET DEPT_NO=V_VEN WHERE CURRENT OF C1;
     
     END IF;
     END LOOP;
     END EJERCICIO_2_R;
     
     EJER.180
     CREATE OR REPLACE PROCEDURE EJERCICIO_3_R(ART VARCHAR2, COD NUMBER, PES NUMBER,
     CAT VARCHAR2, VEN NUMBER, COS NUMBER, EXIS NUMBER)
     AS
     v_count NUMBER(20);
     v_count_cod NUMBER(20);
     
     v_art_exist EXCEPTION;
     v_cod_exist EXCEPTION;
     v_ven_ok EXCEPTION;
     v_cos_ok EXCEPTION;
     v_cos_ven_ok EXCEPTION;
     v_exist_ok EXCEPTION;
     
     BEGIN
     SELECT COUNT(*) INTO v_count FROM ARTICULOS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     SELECT COUNT(*) INTO v_count_cod FROM FABRICANTES WHERE COD_FABRICANTE=COD;
     
     IF (v_count > 0) THEN
     RAISE v_art_exist;
     END IF;
     
     IF (v_count_cod = 0) THEN
     RAISE v_cod_exist;
     END IF;
     
     IF (VEN <= 0) THEN
     RAISE v_ven_ok;
     END IF;
     
     IF (COS <=0) THEN
     RAISE v_cos_oK;
     END IF;
     
     IF (VEN< COS) THEN
     RAISE v_cos_ven_ok;
     END IF;
     
     IF (EXIS <= 0) THEN
     RAISE v_exist_ok;
     END IF;
     
     INSERT INTO ARTICULOS VALUES(ART, COD, PES, CAT, VEN, COS, EXIS);
     
     EXCEPTION
     WHEN v_art_exist THEN
     DBMS_OUTPUT.PUT_LINE('Articulo existe');
     
     WHEN v_cod_exist THEN
     DBMS_OUTPUT.PUT_LINE('Fabricante no existe');
     
     WHEN v_ven_ok THEN
     DBMS_OUTPUT.PUT_LINE('Precio de venta tiene que ser mayor que 0');
     
     WHEN v_cos_oK THEN
     DBMS_OUTPUT.PUT_LINE('Precio de costo tiene que ser mayor que 0');
     
     WHEN v_cos_ven_ok THEN
     DBMS_OUTPUT.PUT_LINE('Precio de costo tiene que ser menor que el precio de venta');
     
     WHEN v_exist_ok THEN
     DBMS_OUTPUT.PUT_LINE('Existencias tiene que ser mayor que 0');
     
     END EJERCICIO_3_R;
     
     EJER.181
     CREATE OR REPLACE PROCEDURE EJERCICIO_4_R
     AS
     CURSOR C1 IS SELECT * FROM EMPLE ORDER BY DEPT_NO, SALARIO;
     cont NUMBER(20);
     v_dept NUMBER(20);
     
     BEGIN
     cont := 1;
     v_dept := 0;
     
     FOR V_REG IN C1 LOOP
     
     IF (v_dept != V_REG.DEPT_NO) THEN
     v_dept :=V_REG.DEPT_NO;
     cont :=1;
     END IF;
     
     IF (cont <= 3) THEN
     DBMS_OUTPUT.PUT_LINE(RPAD(V_REG.EMP_NO,6)||RPAD(V_REG.APELLIDO,15)||RPAD(V_REG.OFICIO,15)||RPAD(NVL(V_REG.DIR,0),6)||RPAD(V_REG.FECHA_ALT,10)||RPAD(V_REG.SALARIO,15)||RPAD(NVL(V_REG.COMISION,0),6)||RPAD(V_REG.DEPT_NO,5));
     END IF;
     
     cont := cont+1;
     END LOOP;
     END EJERCICIO_4_R;
     
     BEGIN EJERCICIO_4_R; END;
     
     EJER.182
     CREATE OR REPLACE PROCEDURE EJERCICIO_5_R (cod NUMBER,por NUMBER, precio NUMBER)
     AS
     CURSOR C1 IS SELECT * FROM ARTICULOS WHERE COD_FABRICANTE=COD FOR UPDATE;
     v_por NUMBER(20);
     v_great NUMBER(20);
     v_count NUMBER(20);
     
     v_precio_ok EXCEPTION;
     v_por_ok EXCEPTION;
     v_cod_exist EXCEPTION;
     BEGIN
     SELECT COUNT(*) INTO v_count FROM FABRICANTES WHERE COD_FABRICANTE=cod;
     
     IF (v_count =0) THEN
     RAISE v_cod_exist;
     END IF;
     
     IF (precio <=0) THEN
     RAISE v_precio_ok;
     END IF;
     
     IF (por <=0) THEN
     RAISE v_por_ok;
     END IF;
     
     FOR V_REG IN C1 LOOP
     v_por :=V_REG.PRECIO_VENTA+(V_REG.PRECIO_VENTA*por)/100;
     v_great :=LEAST(precio, v_por);
     
     UPDATE ARTICULOS SET PRECIO_VENTA =v_great WHERE CURRENT OF C1;
     END LOOP;
     
     EXCEPTION
     WHEN v_cod_exiSt THEN
     DBMS_OUTPUT.PUT_LINE('Fabricante no existe');
     
     WHEN v_precio_ok THEN
     DBMS_OUTPUT.PUT_LINE('Precio no puede ser menor o igual que cero');
     
     
     WHEN v_por_ok THEN
     DBMS_OUTPUT.PUT_LINE('Porcentaje no puede ser menor o igual que cero');
     
     END EJERCICIO_5_R;
     
     EJER.183
     CREATE TABLE T_ARTICULO
     (ARTICULO VARCHAR2(20),
      COD_FABRICANTE NUMBER(2),
      PESO NUMBER(20),
      CATEGORIA VARCHAR2(30),
      UNIDADES_VENDIDAS NUMBER(10),
      UNIDADES_PEDIDAS NUMBER(10))
      
     CREATE OR REPLACE PROCEDURE EJERCICIO_6_R(ART VARCHAR2, COD NUMBER, PESO NUMBER, CAT VARCHAR2, FECHA_B DATE, FECHA_A DATE)
     AS
     V_SUM_V NUMBER(20);
     V_SUM_P NUMBER(20);
     
     BEGIN
     SELECT SUM(UNIDADES_VENDIDAS) INTO V_SUM_V FROM VENTAS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND CATEGORIA=CAT AND FECHA_VENTA BETWEEN FECHA_B AND FECHA_A;
     SELECT SUM(UNIDADES_PEDIDAS) INTO V_SUM_P FROM PEDIDOS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND CATEGORIA=CAT AND FECHA_PEDIDO BETWEEN FECHA_B AND FECHA_A;
     
     INSERT INTO T_ARTICULO VALUES(ART, COD, PESO, CAT, V_SUM_V,V_SUM_P);
     END EJERCICIO_6_R;
     
     EJER.184
     CREATE OR REPLACE PROCEDURE EJERCICIO_7_R(DNOM VARCHAR2)
     AS
     CURSOR C1 IS SELECT DEPT_NO, MAX(SALARIO+NVL(COMISION,0)) SALARIO_MAX, TRUNC(AVG(SALARIO+NVL(COMISION,0)),2) SALARIO_AVG, MIN(SALARIO+NVL(COMISION,0)) SALARIO_MIN, COUNT(*) NUM_EMP FROM EMPLE WHERE DEPT_NO=(SELECT DEPT_NO FROM DEPART WHERE DNOMBRE=DNOM) GROUP BY DEPT_NO;
     BEGIN
     FOR V_REG IN C1 LOOP
     INSERT INTO T_DEPART VALUES (V_REG.DEPT_NO, V_REG.SALARIO_AVG, V_REG.SALARIO_MAX, V_REG.SALARIO_MIN, V_REG.NUM_EMP);
     END LOOP;
     END EJERCICIO_7_R;
     
     CREATE TABLE T_DEPART
     (
      DEPT_NO NUMBER(5),
      SALARIO_MEDIO NUMBER(30),
      SALARIO_MAX NUMBER(30),
      SALARIO_MIN NUMBER(30),
      NUM_EMP NUMBER(30)
     )
     EJER.185
     CREATE OR REPLACE PROCEDURE EJERCICIO_8_R(EMP NUMBER, APE VARCHAR2, OFICIO VARCHAR2, DIR NUMBER, FECHA DATE, SAL NUMBER, COM NUMBER, DEPT NUMBER)
     AS
     V_AVG NUMBER(20);
     V_MAX NUMBER(20);
     V_MIN NUMBER(20);
     V_COUNT NUMBER(20);
     BEGIN
     INSERT INTO EMPLE VALUES(EMP, APE, OFICIO, DIR, FECHA, SAL, COM, DEPT);
     COMMIT;
     SELECT TRUNC(AVG(SALARIO+NVL(COMISION, 0)),2) INTO V_AVG FROM EMPLE WHERE DEPT_NO=DEPT;
     SELECT TRUNC(MAX(SALARIO+NVL(COMISION, 0)),2) INTO V_MAX FROM EMPLE WHERE DEPT_NO=DEPT;
     SELECT TRUNC(MIN(SALARIO+NVL(COMISION, 0)),2) INTO V_MIN FROM EMPLE WHERE DEPT_NO=DEPT;
     SELECT COUNT(*) INTO V_COUNT FROM EMPLE WHERE DEPT_NO=DEPT;
     UPDATE T_DEPART SET SALARIO_MEDIO=V_AVG WHERE DEPT_NO=DEPT;
     UPDATE T_DEPART SET SALARIO_MEDIO=V_MAX WHERE DEPT_NO=DEPT;
     UPDATE T_DEPART SET SALARIO_MEDIO=V_MIN WHERE DEPT_NO=DEPT;
     UPDATE T_DEPART SET SALARIO_MEDIO=V_COUNT WHERE DEPT_NO=DEPT;
     END EJERCICIO_8_R;
     
     EJER.186
     CREATE OR REPLACE PROCEDURE EJERCICIO_9_R
     AS
     CURSOR C1 IS SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM ARTICULOS;
     CURSOR C2 (ART VARCHAR2, COD NUMBER, PES NUMBER , CAT VARCHAR2) IS SELECT NVL(COUNT(*),0) NUMERO_DE _PEDIDOS FROM PEDIDOS
     WHERE ARTICULO=ART AND COD_FABRICANTE= COD AND PESO=PES AND CATEGORIA=CAT;
     BEGIN
     FOR V_REG1 IN C1 LOOP
      FOR V_REG2 IN C2 (V_REG1.ARTICULO, V_REG1.COD_FABRICANTE, V_REG1.PESO, V_REG1.CATEGORIA) LOOP
      DBMS_OUTPUT.PUT_LINE(V_REG1.ARTICULO||V_REG1.COD_FABRICANTE||V_REG1.PESO||V_REG1.CATEGORIA||V_REG2.NUMERO_DE_PEDIDOS);
     END LOOP;
     END LOOP;
     END EJERCICIO_9_R;
     
     EJER.187
     CREATE OR REPLACE PROCEDURE EJERCICIO_10_R
     AS
     CURSOR C1 IS SELECT ARTICULO, COD_FABRICANTE, PESO, CATEGORIA FROM ARTICULOS;
     CURSOR C2 (ART VARCHAR2, COD NUMBER, PES NUMBER , CAT VARCHAR2) IS SELECT NVL(COUNT(*),0) NUMERO_DE _PEDIDOS FROM VENTAS
     WHERE ARTICULO=ART AND COD_FABRICANTE= COD AND PESO=PES AND CATEGORIA=CAT;
     BEGIN
     FOR V_REG1 IN C1 LOOP
      FOR V_REG2 IN C2 (V_REG1.ARTICULO, V_REG1.COD_FABRICANTE, V_REG1.PESO, V_REG1.CATEGORIA) LOOP
      DBMS_OUTPUT.PUT_LINE(V_REG1.ARTICULO||V_REG1.COD_FABRICANTE||V_REG1.PESO||V_REG1.CATEGORIA||V_REG2.NUMERO_DE_PEDIDOS);
     END LOOP;
     END LOOP;
     END EJERCICIO_10_R;
     
     EJER.188
     CREATE OR REPLACE PROCEDURE EJERCICIO_12_R
     AS
     CURSOR C1 IS SELECT * FROM CENTROS C WHERE COD_CENTRO=(SELECT COD_CENTRO FROM CENTROS WHERE COD_CENTRO=C.COD_CENTRO);
     V_SAL NUMBER(20);
     BEGIN
     FOR V_REG IN C1 LOOP
     SELECT SUM(SALARIO) INTO V_SAL FROM PERSONAL WHERE COD_CENTRO=V_REG.COD_CENTRO;
     DBMS_OUTPUT.PUT_LINE(RPAD(V_REG.COD_CENTRO,25)||RPAD(V_REG.TIPO_CENTRO,5)||RPAD(V_REG.NOMBRE,25)||RPAD(V_REG.DIRECCION,25)||RPAD(V_REG.TELEFONO,11)||RPAD(V_REG.NUM_PLAZAS,5)||V_SAL);
     END LOOP;
     END EJERCICIO_12_R;
     
     EJER.189
     CREATE TABLE TIENDA_FACT_PEDIDOS
     (NIF VARCHAR2(7) PRIMARY KEY,
      FACTURACION NUMBER(30));
      
     CREATE OR REPLACE PROCEDURE EJERCICIO_13_R(NI VARCHAR2, ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2, FECH DATE, UNI NUMBER)
     AS
     CURSOR C1 IS SELECT SUM(PRECIO_VENTA*UNIDADES_PEDIDAS) FACTURACION FROM ARTICULOS A, PEDIDOS P WHERE 
     A.ARTICULO=P.ARTICULO AND A.COD_FABRICANTE=P.COD_FABRICANTE AND A.PESO=P.PESO AND A.CATEGORIA=P.CATEGORIA AND P.NIF=NI;
     V_COUNT NUMBER(20);
     BEGIN
     SELECT COUNT(*) INTO V_COUNT FROM TIENDA_FACT_PEDIDOS  WHERE NIF=NI;
     INSERT INTO PEDIDOS VALUES(NI, ART, COD, PES, CAT, FECH, UNI); 
     COMMIT;
     FOR V_REG IN C1 LOOP
     DBMS_OUTPUT.PUT_LINE('FACTURACION '|| V_REG.FACTURACION);
     IF(V_COUNT=0) THEN
     INSERT INTO TIENDA_FACT_PEDIDOS VALUES(NI, V_REG.FACTURACION);
     ELSE
     UPDATE TIENDA_FACT_PEDIDOS SET FACTURACION=V_REG.FACTURACION WHERE NIF=NI;
     END IF;
     END LOOP;
     END EJERCICIO_13_R;
     
     EJER.190
     CREATE TABLE TIENDA_FACT_VENTAS
     (NIF VARCHAR2(7) PRIMARY KEY,
      FACTURACION NUMBER(30));
     
     CREATE OR REPLACE PROCEDURE EJERCICIO_14_R(NI VARCHAR2, ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2, FECH DATE, UNI NUMBER)
     AS
     CURSOR C1 IS SELECT SUM(PRECIO_VENTA*UNIDADES_VENDIDAS) FACTURACION FROM ARTICULOS A, VENTAS P WHERE 
     A.ARTICULO=P.ARTICULO AND A.COD_FABRICANTE=P.COD_FABRICANTE AND A.PESO=P.PESO AND A.CATEGORIA=P.CATEGORIA AND P.NIF=NI;
     V_COUNT NUMBER(20);
     BEGIN
     SELECT COUNT(*) INTO V_COUNT FROM TIENDA_FACT_VENTAS  WHERE NIF=NI;
     INSERT INTO PEDIDOS VALUES(NI, ART, COD, PES, CAT, FECH, UNI); 
     COMMIT;
     FOR V_REG IN C1 LOOP
     DBMS_OUTPUT.PUT_LINE('FACTURACION '|| V_REG.FACTURACION);
     IF(V_COUNT=0) THEN
     INSERT INTO TIENDA_FACT_PEDIDOS VALUES(NI, V_REG.FACTURACION);
     ELSE
     UPDATE TIENDA_FACT_PEDIDOS SET FACTURACION=V_REG.FACTURACION WHERE NIF=NI;
     END IF;
     END LOOP;
     END EJERCICIO_14_R;
     
     EJER.191
     CREATE OR REPLACE TRIGGER EJ_TRIGGER
     AFTER INSERT ON VENTAS FOR EACH ROW
     BEGIN
     UPDATE ARTICULOS SET EXISTENCIAS=EXISTENCIAS-:NEW.UNIDADES_VENDIDAS
     WHERE ARTICULO=:NEW.ARTICULO AND COD_FABRICANTE=:NEW.COD_FABRICANTE AND PESO=:NEW.PESO AND CATEGORIA=:NEW.CATEGORIA;
     END EJ_TRIGGER;
     
     EJER.192
     CREATE OR REPLACE TRIGGER EJER_2_L
     BEFORE UPDATE ON EMPLE 
     FOR EACH ROW
     DECLARE 
     v_cad VARCHAR2(200);
     BEGIN
     v_cad :=TO_CHAR(SYSDATE, 'DD/MM/YYYY*HH24:MI*')||:OLD.EMP_NO||:OLD.APELLIDO||'* MODIFICACION *';
      IF (:OLD.EMP_NO !=:NEW.EMP_NO) THEN 
       v_cad := v_cad||:OLD.EMP_NO||'*'|| :NEW.EMP_NO;
      END IF;
      IF (:OLD.APELLIDO !=:NEW.APELLIDO) THEN
       v_cad:= v_cad||:OLD.APELLIDO||'*'||:NEW.EMP_NO;
      END IF;
      IF (:OLD.OFICIO!=:NEW.APELLIDO) THEN
       v_cad:= v_cad||:OLD.OFICIO||'*'||:NEW.OFICIO;
      END IF;
      IF (:OLD.DIR!=:NEW.DIR) THEN
       v_cad:= v_cad||:OLD.DIR||'*'||:NEW.DIR;
      END IF;
      IF (:OLD.FECHA_ALT!=:NEW.FECHA_ALT) THEN
       v_cad:= v_cad||:OLD.FECHA_ALT||'*'||:NEW.FECHA_ALT;
      END IF;
      IF (:OLD.SALARIO!=:NEW.SALARIO) THEN
       v_cad:= v_cad||:OLD.SALARIO||'*'||:NEW.SALARIO;
      END IF;
      IF (:OLD.COMISION!=:NEW.COMISION) THEN
       v_cad:=v_cad||:OLD.COMISION||'*'||:NEW.SALARIO;
      END IF;
      IF (:OLD.DEPT_NO!=:NEW.DEPT_NO) THEN
       v_cad:=v_cad||:OLD.DEPT_NO||'*'||:NEW.DEPT_NO;
      END IF;
     
      INSERT INTO AUDITAREMPLE VALUES(v_cad);
     
     END EJER_2_L;
     
     EJER.193
     CREATE TABLE AUDITAR_ARTICULOS(
     ARTICULO VARCHAR2(40),
     COD_FABRICANTE NUMBER(2),
     PESO NUMBER(10),
     CATEGORIA VARCHAR2(40),
     USUARIO VARCHAR2(40),
     FECHA DATE,
     TIPO_MODIFICACION VARCHAR2(40));Ç
     
     CREATE OR REPLACE TRIGGER EJER_6_R
     BEFORE INSERT OR DELETE OR UPDATE ON ARTICULOS
     FOR EACH ROW
     BEGIN
     IF INSERTING THEN
     INSERT INTO AUDITAR_ARTICULOS VALUES(:NEW.ARTICULO, :NEW.COD_FABRICANTE, :NEW.PESO, :NEW.CATEGORIA, USER, SYSDATE, 'INSERTADO');
     
     ELSIF DELETING THEN
     INSERT INTO AUDITAR_ARTICULOS VALUES(:OLD.ARTICULO, :OLD.COD_FABRICANTE, :OLD.PESO, :OLD.CATEGORIA, USER, SYSDATE, 'BORRADO');
     
     ELSE
      INSERT INTO AUDITAR_ARTICULOS VALUES(:OLD.ARTICULO||'*'||:NEW.ARTICULO, :OLD.COD_FABRICANTE||'*'||:NEW.COD_FABRICANTE, :OLD.PESO||'*'||:NEW.PESO, :OLD.CATEGORIA||'*'||:NEW.CATEGORIA, USER, SYSDATE, 'ACTUALIZADO_1');
     END IF;
     END EJER_6_R
     
     EJER.194
     a)
     CREATE OR REPLACE TRIGGER EJER_7_R
     BEFORE INSERT ON NUEVOS
     FOR EACH ROW
     BEGIN
     INSERT INTO ALUM VALUES(:NEW.NOMBRE, :NEW.EDAD, :NEW.LOCALIDAD);
     END EJER_7_R;
     
     INSERT INTO NUEVOS VALUES('SAMUEL', 20, 'ARANJUEZ');
     
     b)
     CREATE OR REPLACE TRIGGER EJER_7_R_B
     AFTER DELETE ON ALUM
     FOR EACH ROW
     BEGIN
     INSERT INTO ANTIGUOS VALUES(:OLD.NOMBRE, :OLD.EDAD, :OLD.LOCALIDAD);
     DELETE FROM NUEVOS WHERE NOMBRE=:OLD.NOMBRE AND EDAD=:OLD.EDAD AND LOCALIDAD=:OLD.LOCALIDAD;
     END EJER_7_R_B;
     
     EJER.195
     CREATE OR REPLACE TRIGGER EJER_11_R
     BEFORE INSERT OR UPDATE OR DELETE ON PROFESORES
     FOR EACH ROW
     BEGIN
     IF INSERTING THEN
     INSERT INTO PERSONAL VALUES(:NEW.COD_CENTRO, :NEW.DNI, :NEW.APELLIDOS, 'PROFESOR', 220000);
     END IF;
     IF DELETING THEN
     DELETE FROM PERSONAL WHERE COD_CENTRO=:OLD.COD_CENTRO AND DNI=:OLD.DNI AND APELLIDOS=:OLD.APELLIDOS;
     END IF;
     IF UPDATING THEN
     UPDATE PERSONAL SET COD_CENTRO=:NEW.COD_CENTRO, DNI=:NEW.DNI, APELLIDOS=:NEW.APELLIDOS WHERE APELLIDOS=:OLD.APELLIDOS AND DNI=:OLD.DNI AND COD_CENTRO=:OLD.COD_CENTRO;
     END IF;
     END EJER_11_R;
     
     INSERT INTO PROFESORES VALUES(45, 5555555, 'Garcia Escudero, Samuel', 'INFORMATICA');
     UPDATE PROFESORES SET COD_CENTRO=22 WHERE DNI=5555555;
     DELETE FROM PROFESORES WHERE DNI=5555555
     
     EJER.196
     CREATE OR REPLACE TRIGGER EJER_12_R
     BEFORE INSERT OR UPDATE OR DELETE ON PERSONAL
     FOR EACH ROW
     WHEN (UPPER(NEW.FUNCION)= 'PROFESOR') 
     BEGIN
     IF INSERTING THEN
     	INSERT INTO PROFESORES VALUES(:NEW.COD_CENTRO,:NEW.DNI,:NEW.APELLIDOS,NULL);
     END IF;
     IF UPDATING THEN
     	UPDATE PROFESORES SET COD_CENTRO = :NEW.COD_CENTRO, DNI = :NEW.DNI, APELLIDOS = :NEW.APELLIDOS WHERE DNI= :OLD.DNI;
     END IF;
     IF DELETING THEN
     	DELETE FROM PROFESORES WHERE DNI=:OLD.DNI;
     END IF;
     
     END EJER_12_R;
     
     EJER.197
     
     CREATE OR REPLACE VIEW COFAB
     AS
     SELECT MATRICULA, MODELO, MOTOR, FABRICANTE, PAIS FROM COCHES C, FABRICANTES_C F WHERE C.COD_FAB=F.COD_FAB
     
     CREATE OR REPLACE TRIGGER EJER_13_R
     INSTEAD OF INSERT OR UPDATE OR DELETE ON COFAB 
     FOR EACH ROW
     DECLARE
     v_cod NUMBER(10);
     BEGIN
     IF DELETING THEN
      DELETE FROM COCHES WHERE MATRICULA=:OLD.MATRICULA;
     ELSIF INSERTING THEN
      SELECT COD_FAB INTO v_cod FROM FABRICANTES_C WHERE FABRICANTE=:NEW.FABRICANTE;
      INSERT INTO COCHES VALUES (:NEW.MATRICULA, :NEW.MODELO, :NEW.MOTOR, NULL, SYSDATE, v_cod);
     ELSIF UPDATING('MOTOR') THEN
      UPDATE COCHES SET MOTOR=:NEW.MOTOR WHERE MATRICULA=:OLD.MATRICULA;
     ELSIF UPDATING('MATRICULA') THEN
      UPDATE COCHES SET MATRICULA=:NEW.MATRICULA WHERE MATRICULA=:OLD.MATRICULA;
     END IF;
     END EJER_13_R;
     
     EJER.198
     
     CREATE OR REPLACE VIEW CEN_PRO
     AS
     SELECT NOMBRE, TELEFONO, DNI,APELLIDOS, ESPECIALIDAD FROM CENTROS NATURAL JOIN PROFESORES
     
     CREATE OR REPLACE TRIGGER EJER_14_R
     INSTEAD OF DELETE OR INSERT OR UPDATE ON CEN_PRO
     FOR EACH ROW
     DECLARE
     v_centro NUMBER(2);
     v_count NUMBER(1);
     e_cod EXCEPTION;
     BEGIN
     SELECT COUNT(*) INTO v_count FROM CENTROS WHERE NOMBRE=:NEW.NOMBRE;
     IF (v_count=1) THEN
     IF INSERTING THEN
     SELECT COD_CENTRO INTO v_centro FROM CENTROS WHERE NOMBRE=:NEW.NOMBRE;
     INSERT INTO PROFESORES VALUES(v_centro, :NEW.DNI, :NEW.APELLIDOS, :NEW.ESPECIALIDAD);
     ELSIF DELETING THEN
     DELETE FROM PROFESORES WHERE DNI=:OLD.DNI;
     ELSIF UPDATING THEN
     UPDATE PROFESORES SET COD_CENTRO=(SELECT COD_CENTRO FROM CENTROS WHERE NOMBRE=:NEW.NOMBRE) WHERE APELLIDOS=:OLD.APELLIDOS;
     END IF;
     ELSE
     RAISE e_cod;
     END IF;
     EXCEPTION
     WHEN e_cod THEN
     DBMS_OUTPUT.PUT_LINE('ERROR');
     END EJER_14_R;
     
     EJER.199
     CREATE OR REPLACE VIEW EMP_DEP
     AS
     SELECT EMP_NO, APELLIDO, OFICIO, SALARIO, DNOMBRE, DEPT_NO FROM DEPART NATURAL JOIN EMPLE;
     
     CREATE OR REPLACE TRIGGER EJER_1_R
     INSTEAD OF INSERT OR DELETE OR UPDATE ON EMP_DEP
     FOR EACH ROW
     BEGIN
     IF INSERTING THEN
     INSERT INTO EMPLE VALUES(:NEW.EMP_NO, :NEW.APELLIDO, :NEW.OFICIO, NULL, SYSDATE,:NEW.SALARIO, NULL, :NEW.DEPT_NO);
     ELSIF UPDATING ('DEPT_NO') THEN
     UPDATE EMPLE SET DEPT_NO=:NEW.DEPT_NO WHERE EMP_NO=:OLD.EMP_NO;
     ELSIF UPDATING ('EMP_NO') THEN
     UPDATE EMPLE SET EMP_NO=:NEW.EMP_NO WHERE EMP_NO=:OLD.EMP_NO;
     ELSIF UPDATING ('APELLIDO') THEN
     UPDATE EMPLE SET APELLIDO=:NEW.APELLIDO WHERE EMP_NO=:OLD.EMP_NO;
     ELSIF UPDATING ('OFICIO') THEN
     UPDATE EMPLE SET OFICIO=:NEW.OFICIO WHERE EMP_NO=:OLD.EMP_NO;
     ELSIF UPDATING ('SALARIO') THEN
     UPDATE EMPLE SET SALARIO=:NEW.SALARIO WHERE EMP_NO=:OLD.EMP_NO;
     ELSIF DELETING THEN
     DELETE FROM EMPLE WHERE EMP_NO=:OLD.EMP_NO;
     END IF;
     END EJER_1_R;
     
     EJER.200
     CREATE OR REPLACE TRIGGER EJER_2_R
     INSTEAD OF DELERE OR INSERT OR UPDATE ON ART_PED
     FOR EACH ROW
     DECLARE
     v_count NUMBER(1);
     BEGIN
      IF INSERTING THEN
     	SELECT COUNT(*) INTO v_count FROM ARTICULOS WHERE ARTICULO=:NEW.ARTICULO AND COD_FABRICANTE=:NEW.COD_FABRICANTE AND CATEGORIA=:NEW.CATEGORIA AND PESO=:NEW.PESO;
     	IF (v_count=1) THEN
     		INSERT INTO PEDIDOS VALUES(:NEW.ARTICULO, :NEW.COD_FABRICANTE, :NEW.PESO, :NEW.CATEGORIA, :NEW.NIF, SYSDATE, :NEW.UNIDADES_PEDIDAS);
     	ELSE
     		RAISE e_e_a;
     	END IF;
     ELSIF UPDATING ('NIF') THEN
     	UPDATE PEDIDOS SET NIF=:NEW.NIF WHERE ARTICULO=:OLD.ARTICULO AND COD_FABRICANTE=:OLD.COD_FABRICANTE AND CATEGORIA=:OLD.CATEGORIA AND PESO=:OLD.PESO;
     ELSIF UPDATING ('FECHA_PEDIDO') THEN
     	UPDATE PEDIDOS SET FECHA_PEDIDO=:NEW.FECHA_PEDIDO WHERE ARTICULO=:OLD.ARTICULO AND COD_FABRICANTE=:OLD.COD_FABRICANTE AND CATEGORIA=:OLD.CATEGORIA AND PESO=:OLD.PESO;
     ELSIF UPDATING ('UNIDADES_PEDIDAS') THEN
     	UPDATE PEDIDOS SET UNIDADES_PEDIDAS=:NEW.UNIDADES_PEDIDAS WHERE ARTICULO=:OLD.ARTICULO AND COD_FABRICANTE=:OLD.COD_FABRICANTE AND CATEGORIA=:OLD.CATEGORIA AND PESO=:OLD.PESO;
     ELSIF DELETING THEN
     	DELETE FROM PEDIDOS WHERE ARTICULO=:OLD.ARTICULO AND COD_FABRICANTE=:OLD.COD_FABRICANTE AND CATEGORIA=:OLD.CATEGORIA AND PESO=:OLD.PESO;
     END IF;
     END EJER_2_R;
     
     EJER.201
     CREATE OR REPLACE PACKAGE BODY EJER_4_L
     AS
     
     PROCEDURE INSERT_EJER_4_L (v_dnom VARCHAR2, v_loc VARCHAR2)
     AS
     v_dep NUMBER(10);
     v_count NUMBER(10);
     BEGIN
     
     SELECT COUNT(*) INTO v_count FROM DEPART WHERE DNOMBRE=v_dnom;
     
     IF (v_count=0) THEN
     SELECT TRUNC(MAX(DEPT_NO),-1) INTO v_dep FROM DEPART;
     v_dep := v_dep+10;
     INSERT INTO DEPART VALUES(v_dep, v_dnom, v_loc);
     END IF;
     
     END INSERT_EJER_4_L;
     
     PROCEDURE DELETE_EJER_4_L (v_dep_nom NUMBER, v_dep_nue NUMBER)
     AS
     BEGIN
     UPDATE EMPLE SET DEPT_NO=v_dep_nue WHERE DEPT_NO=v_dep_nom;
     DELETE FROM DEPART WHERE DEPT_NO=v_dep_nom;
     
     END DELETE_EJER_4_L;
     
     END EJER_4_L;
     
     EJER.202
     CREATE OR REPLACE PACKAGE EJER_4_R
     AS
     PROCEDURE INSERT_EJER_4_R (v_cod NUMBER, v_nom VARCHAR2);
     PROCEDURE DELETE_EJER_4_R (v_cod_nom NUMBER);
     PROCEDURE UPDATE_EJER_4_R (v_cod NUMBER, v_nom VARCHAR2);
     END EJER_4_R;
     
     CREATE OR REPLACE PACKAGE BODY EJER_4_R
     AS
     
     PROCEDURE INSERT_EJER_4_R (v_cod NUMBER, v_nom VARCHAR2)
     AS
     v_count NUMBER(10);
     BEGIN
     SELECT COUNT(*) INTO v_count FROM CENTROS WHERE COD_CENTRO=v_cod;
     IF (v_count=0) THEN
     INSERT INTO CENTROS VALUES(v_cod, NULL, UPPER(v_nom), NULL, NULL, NULL);
     END IF;
     END INSERT_EJER_4_R;
     
     PROCEDURE DELETE_EJER_4_R (v_cod_nom NUMBER)
     AS
     v_cod_1 NUMBER(10);
     v_nom VARCHAR2(10);
     BEGIN
     v_cod_1 :=TRUNC(v_cod_nom,-1)+1;
     SELECT NOMBRE INTO v_nom FROM CENTROS WHERE COD_CENTRO=v_cod_nom;
      INSERT INTO CENTROS SELECT v_cod_1, TIPO_CENTRO, CONCAT(CONCAT('AUX_',v_nom),'_ELIMINADO'), DIRECCION, TELEFONO, NUM_PLAZAS FROM CENTROS WHERE COD_CENTRO=v_cod_nom;
     DELETE FROM CENTROS WHERE COD_CENTRO=v_cod_nom;
     END DELETE_EJER_4_R;
     
     PROCEDURE UPDATE_EJER_4_R (v_cod NUMBER, v_nom VARCHAR2)
     AS
     BEGIN
     UPDATE CENTROS SET NOMBRE=v_nom WHERE COD_CENTRO=v_cod;
     END UPDATE_EJER_4_R;
     
     END EJER_4_R;
     
     EJER.202
     
     CREATE TABLE H_ARTICULOS
     AS
     SELECT * FROM ARTICULOS
     
     CREATE TABLE H_VENTAS
     AS
     SELECT * FROM VENTAS
     
     CREATE TABLE H_PEDIDOS
     AS
     SELECT * FROM PEDIDOS
     
     DELETE FROM H_ARTICULOS
     
     CREATE OR REPLACE PACKAGE EJER_5_R
     AS
     PROCEDURE DELETE_ARTICULO (ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2);
     PROCEDURE INSERT_ARTICULO (ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2, PRE_VEN NUMBER, PRE_COS NUMBER, EXIS NUMBER);
     PROCEDURE UPDATE_ARTICULO (ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2, PRE_VEN NUMBER DEFAULT NULL, PRE_COS NUMBER DEFAULT NULL, EXIS NUMBER DEFAULT NULL);
     END EJER_5_R;
     
     CREATE OR REPLACE PACKAGE BODY EJER_5_R
     AS
     
     PROCEDURE DELETE_ARTICULO (ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2)
     AS
     CURSOR C1 IS SELECT * FROM PEDIDOS  WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     CURSOR C2 IS SELECT * FROM VENTAS  WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     v_in ARTICULOS%ROWTYPE;
     BEGIN
     SELECT * INTO v_in FROM ARTICULOS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     INSERT INTO H_ARTICULOS VALUES (v_in.ARTICULO, v_in.COD_FABRICANTE, v_in.PESO, v_in.CATEGORIA, v_in.PRECIO_VENTA, v_in.PRECIO_COSTO, v_in.EXISTENCIAS);
     FOR v_reg IN C1 LOOP
     INSERT INTO H_PEDIDOS VALUES (v_reg.NIF, v_reg.ARTICULO, v_reg.COD_FABRICANTE, v_reg.PESO, v_reg.CATEGORIA, v_reg.FECHA_PEDIDO, v_reg.UNIDADES_PEDIDAS);
     END LOOP;
     FOR V_RE IN C2 LOOP
     INSERT INTO H_VENTAS VALUES (V_RE.NIF, V_RE.ARTICULO, V_RE.COD_FABRICANTE, V_RE.PESO, V_RE.CATEGORIA, V_RE.FECHA_VENTA, V_RE.UNIDADES_VENDIDAS);
     END LOOP;
     DELETE FROM ARTICULOS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     DELETE FROM PEDIDOS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     DELETE FROM VENTAS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     END DELETE_ARTICULO;
     
     PROCEDURE INSERT_ARTICULO (ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2, PRE_VEN NUMBER, PRE_COS NUMBER, EXIS NUMBER)
     AS
     v_art NUMBER(10);
     v_cod NUMBER(10);
     
     v_art_exis EXCEPTION;
     v_cod_exis EXCEPTION;
     v_pre_ven EXCEPTION;
     v_pre_cos EXCEPTION;
     v_pre_cos_may EXCEPTION;
     v_exis EXCEPTION;
     
     BEGIN
     SELECT COUNT(*) INTO v_art FROM ARTICULOS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     SELECT COUNT(*) INTO v_cod FROM FABRICANTES WHERE COD_FABRICANTE=COD;
     IF (v_art <> 0) THEN
     RAISE v_art_exis;
     END IF;
     IF (v_cod=0) THEN
     RAISE v_cod_exis;
     END IF;
     IF (PRE_VEN < 0) THEN
     RAISE v_pre_ven;
     END IF;
     IF (PRE_COS < 0) THEN
     RAISE v_pre_cos;
     END IF;
     IF (PRE_COS>PRE_VEN) THEN
     RAISE v_pre_cos_may;
     END IF;
     IF (EXIS <0) THEN
     RAISE v_exis;
     END IF;
     
     INSERT INTO ARTICULOS VALUES(ART, COD, PES, CAT, PRE_VEN, PRE_COS, EXIS);
     EXCEPTION
     WHEN v_art_exis THEN
     DBMS_OUTPUT.PUT_LINE('ERROR_1');
     WHEN v_cod_exis THEN
     DBMS_OUTPUT.PUT_LINE('ERROR_1');
     WHEN v_pre_ven THEN
     DBMS_OUTPUT.PUT_LINE('ERROR_1');
     WHEN v_pre_cos THEN
     DBMS_OUTPUT.PUT_LINE('ERROR_1');
     WHEN v_pre_cos_may THEN
     DBMS_OUTPUT.PUT_LINE('ERROR_1');
     WHEN v_exis THEN
     DBMS_OUTPUT.PUT_LINE('ERROR_1');
     END INSERT_ARTICULO;
     
     PROCEDURE UPDATE_ARTICULO (ART VARCHAR2, COD NUMBER, PES NUMBER, CAT VARCHAR2, PRE_VEN NUMBER DEFAULT NULL, PRE_COS NUMBER DEFAULT NULL, EXIS NUMBER DEFAULT NULL)
     AS
     BEGIN
     IF PRE_VEN IS NOT NULL THEN
     UPDATE ARTICULOS SET PRECIO_VENTA=PRE_VEN WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     END IF;
     IF PRE_COS IS NOT NULL THEN
     UPDATE ARTICULOS SET PRECIO_COSTO=PRE_COS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     END IF;
     IF EXIS IS NOT NULL THEN
     UPDATE ARTICULOS SET PRECIO_VENTA=PRE_VEN, PRECIO_COSTO=PRE_COS, EXISTENCIAS=EXIS WHERE ARTICULO=ART AND COD_FABRICANTE=COD AND PESO=PES AND CATEGORIA=CAT;
     END IF;
     END UPDATE_ARTICULO;
     
     END EJER_5_R;
     
     EJER.204
     
     CREATE OR REPLACE PACKAGE EJER_8_R
     AS
     PROCEDURE INSERT_TIENDAS (N VARCHAR2, NOM VARCHAR2, DIR VARCHAR2, POB VARCHAR2, PRO VARCHAR2, CODP NUMBER);
     PROCEDURE DELETE_TIENDAS (N VARCHAR2);
     PROCEDURE UPDATE_TIENDAS (N VARCHAR2, NOM VARCHAR2 , DIR VARCHAR2 , POB VARCHAR2 , PRO VARCHAR2 , CODP NUMBER , N_N VARCHAR2 DEFAULT NULL);
     END EJER_8_R;
     
     CREATE OR REPLACE PACKAGE BODY EJER_8_R
     AS
     
     PROCEDURE INSERT_TIENDAS (N VARCHAR2, NOM VARCHAR2, DIR VARCHAR2, POB VARCHAR2, PRO VARCHAR2, CODP NUMBER)
     AS
     v_codp EXCEPTION;
     BEGIN
     IF (CODP < 0) THEN
     RAISE v_codp;
     END IF;
     INSERT INTO TIENDAS VALUES(N, NOM, DIR, POB, PRO, CODP);
     EXCEPTION
     WHEN v_codp THEN
     DBMS_OUTPUT.PUT_LINE('ERROR');
     END INSERT_TIENDAS;
     
     PROCEDURE DELETE_TIENDAS (N VARCHAR2)
     AS
     CURSOR C1 IS SELECT * FROM PEDIDOS WHERE NIF=N;
     CURSOR C2 IS SELECT * FROM VENTAS WHERE NIF=N;
     BEGIN
     INSERT INTO H_TIENDAS SELECT * FROM TIENDAS WHERE NIF=N;
     FOR V_REG IN C1 LOOP
     INSERT INTO H_PEDIDOS VALUES (V_REG.NIF, V_REG.ARTICULO, V_REG.COD_FABRICANTE, V_REG.PESO, V_REG.CATEGORIA, V_REG.FECHA_PEDIDO, V_REG.UNIDADES_PEDIDAS);
     END LOOP;
     FOR V_REG_1 IN C2 LOOP
     INSERT INTO H_VENTAS VALUES (V_REG_1.NIF, V_REG_1.ARTICULO, V_REG_1.COD_FABRICANTE, V_REG_1.PESO, V_REG_1.CATEGORIA, V_REG_1.FECHA_VENTA, V_REG_1.UNIDADES_VENDIDAS);
     END LOOP;
     DELETE FROM TIENDAS WHERE NIF=N;
     END DELETE_TIENDAS;
     
     PROCEDURE UPDATE_TIENDAS (N VARCHAR2, NOM VARCHAR2 , DIR VARCHAR2 , POB VARCHAR2 , PRO VARCHAR2 , CODP NUMBER , N_N VARCHAR2 DEFAULT NULL)
     AS
     BEGIN
     UPDATE TIENDAS SET NOMBRE=NOM, DIRECCION=DIR, POBLACION=POB, PROVINCIA=PRO, CODPOSTAL=CODP WHERE NIF=N;
     IF N_N IS NOT NULL THEN
     UPDATE TIENDAS SET NIF=N_N WHERE NIF=N;
     UPDATE H_TIENDAS SET NIF=N_N WHERE NIF=N;
     UPDATE PEDIDOS SET NIF=N_N WHERE NIF=N;
     UPDATE VENTAS SET NIF=N_N WHERE NIF=N;
     UPDATE H_PEDIDOS SET NIF=N_N WHERE NIF=N;
     UPDATE H_VENTAS SET NIF=N_N WHERE NIF=N;
     END IF;
     END UPDATE_TIENDAS;
     END EJER_8_R;
     
     EJER.205
     CREATE TABLE PROVINCIAS
     (COD_PROVINCIA NUMBER(2) PRIMARY KEY,
     NOM_PROVINCIA VARCHAR2(15))
     
     CREATE TABLE PERSONAS
     (
     DNI NUMBER(6) PRIMARY KEY,
     NOMBRE VARCHAR2(15),
     DIRECCION VARCHAR2(15),
     POBLACION VARCHAR2(20),
     CODPROVIN NUMBER(2) NOT NULL REFERENCES PROVINCIAS
     )
     
     CREATE TABLE EST_PROVINCIAS
     (
     COD_PROV NUMBER(2),
     NOM_PROV VARCHAR2(15),
     NUM_PER NUMBER(3)
     )
     
     CREATE OR REPLACE PACKAGE EJER_10_R
     AS
     PROCEDURE INSERT_PERSONAS(D NUMBER, NOM VARCHAR2, DIR VARCHAR2, POB VARCHAR2, COD NUMBER);
     PROCEDURE DELETE_PERSONAS(D NUMBER);
     PROCEDURE UPDATE_PERSONAS(D NUMBER, NOM VARCHAR2, DIR VARCHAR2, POB VARCHAR2, COD NUMBER);
     END EJER_10_R;
     
     CREATE OR REPLACE PACKAGE EJER_10_R
     AS
     PROCEDURE INSERT_PERSONAS(D NUMBER, NOM VARCHAR2, DIR VARCHAR2, POB VARCHAR2, COD NUMBER)
     AS
     v_num NUMBER(3);
     v_count NUMBER(3);
     BEGIN
     INSERT INTO PERSONAS VALUES(D, NOM, DIR , POB, COD);
     SELECT COUNT(*) INTO v_num FROM PERSONAS WHERE CODPROVIN=COD;
     SELECT COUNT(*) INTO v_count FROM PROVINCIAS WHERE COD_PROVINCIA=COD;
     
     IF (v_count=0) THEN
     INSERT INTO EST_PROVINCIAS SELECT COD_PROVINCIA, NOM_PROVINCIA, v_num FROM PROVINCIAS WHERE COD_PROVINCIA=COD;
     ELSE 
     UPDATE EST_PROVINCIAS SET NUM_PER=v_num WHERE COD_PROV=COD;
     END IF;
     END INSERT_PERSONAS;
     
     PROCEDURE DELETE_PERSONAS(D NUMBER)
     AS
     v_cod NUMBER(2);
     v_num NUMBER(2);
     BEGIN
     SELECT CODPROVIN INTO v_cod FROM PERSONAS WHERE DNI=D;
     DELETE FROM PERSONAS WHERE DNI=D;
     SELECT COUNT(*) INTO v_num FROM PERSONAS WHERE CODPROVIN=v_cod;
     UPDATE EST_PROVINCIAS SET NUM_PER=v_num WHERE COD_PROV=v_cod;
     END DELETE_PERSONAS;
     
     PROCEDURE UPDATE_PERSONAS(D NUMBER, NOM VARCHAR2, DIR VARCHAR2, POB VARCHAR2, COD NUMBER DEFAULT NULL, D_D NUMBER DEFAULT NULL)
     AS
     v_cod NUMBER(3);
     v_num NUMBER(3);
     BEGIN
     UPDATE PERSONAS SET NOMBRE=NOM, DIRECCION=DIR, POBLACION=POB WHERE DNI=D;
     
     IF COD IS NOT NULL THEN
     UPDATE PERSONAS SET CODPROVIN=COD WHERE DNI=D;
     SELECT CODPROVIN INTO v_cod FROM PERSONAS WHERE DNI=D;
     SELECT COUNT(*) INTO v_num FROM PERSONAS WHERE CODPROVIN=COD;
     UPDATE EST_PROVINCIAS SET NUM_PER=v_num WHERE COD_PROV=COD;
     END IF;
     
     IF D_D IS NOT NULL THEN
     UPDATE PERSONAS SET DNI=D_D WHERE DNI=D;
     END IF;
     END UPDATE_PERSONAS;
     
     END EJER_10_R;
     
     EJER.206
     
     CREATE OR REPLACE PROCEDURE EJER_DICTADO
     AS
     TYPE t_centros IS TABLE OF CENTROS%ROWTYPE
     INDEX BY BINARY_INTEGER;
     ta_centros t_centros;
     CURSOR C1 IS SELECT * FROM CENTROS;
     BEGIN
     FOR V_REG IN C1 LOOP
     ta_centros(V_REG.COD_CENTRO) := V_REG;
     DBMS_OUTPUT.PUT_LINE(ta_centros(V_REG.COD_CENTRO).NOMBRE);
     END LOOP;
     END EJER_DICTADO;
     
     EJER.207
     CREATE OR REPLACE PACKAGE EJER_4_A
     AS
     	CURSOR C1 (COD NUMBER) RETURN PROFESORES%ROWTYPE;
     	CURSOR C2 (COD NUMBER) RETURN PERSONAL%ROWTYPE;
     	PROCEDURE carga_table;
     	PROCEDURE insert_profesores(COD NUMBER, D NUMBER, NOM VARCHAR2, ESP VARCHAR2);
     	PROCEDURE borrar_centro(COD NUMBER);
     END EJER_4_A;
     
     CREATE OR REPLACE PACKAGE BODY EJER_4_A
     AS
     	TYPE t_centros IS TABLE OF CENTROS%ROWTYPE INDEX BY BINARY_INTEGER;
     	tab_centros t_centros;
     	
     	CURSOR C1(COD NUMBER) RETURN PROFESORES%ROWTYPE IS 
     		SELECT * FROM PROFESORES WHERE COD_CENTRO=COD FOR UPDATE;
     	CURSOR C2(COD NUMBER ) RETURN PERSONAL%ROWTYPE IS
     		SELECT * FROM PERSONAL WHERE COD_CENTRO=COD FOR UPDATE;
     	
     	PROCEDURE carga_table
     		AS
     		CURSOR C3 IS SELECT * FROM CENTROS;
     		BEGIN
     		FOR V_REG IN C3 LOOP
     		tab_centros(V_REG.COD_CENTRO):= V_REG;
     		END LOOP;
     
     	END carga_table;
     	
     	PROCEDURE insert_profesores (COD NUMBER, D NUMBER, NOM VARCHAR2, ESP VARCHAR2)
     	AS
     	BEGIN
     
     		carga_table;
     
     IF tab_centros.EXISTS(COD) THEN
     NULL;
     ELSE 
     INSERT INTO CENTROS VALUES(COD, NULL, NULL, NULL, NULL, NULL);
     tab_centros.DELETE;
     		carga_table;
     		END IF;
     
     		INSERT INTO PROFESORES VALUES(COD, D, NOM, ESP);
     		EXCEPTION
     		WHEN OTHERS THEN
     		DBMS_OUTPUT.PUT_LINE('ERROR');
     	END insert_profesores;
     	
     	PROCEDURE borrar_centro (COD NUMBER)
     	AS
     		n_per NUMBER(2);
     		n_pro NUMBER(2);
     
     		exis_centros EXCEPTION;
     
     	BEGIN
     		carga_table;
     		n_pro := 0;
     		n_per := 0;
     
     		IF tab_centros.EXISTS(COD) THEN
     		RAISE exis_centros;
     		END IF;
     
     		FOR V_REG IN C1(COD) LOOP
     		DELETE FROM PROFESORES WHERE CURRENT OF C1;
     		n_pro :=n_pro+1;
     		END LOOP;
     
     		FOR V_REG_1 IN C2(COD) LOOP
     		DELETE FROM PROFESORES WHERE CURRENT OF C2;
     		n_per :=n_per+1;
     		END LOOP;
     
     		tab_centros.DELETE(COD);
     
     		DBMS_OUTPUT.PUT_LINE(RPAD(n_pro,5)||n_per);
     	EXCEPTION
     		WHEN exis_centros THEN
     		 DBMS_OUTPUT.PUT_LINE('ERROR');
     		 
     	END borrar_centro;
     		
     END EJER_4_A;
     
     EJER.208
     CREATE OR REPLACE PACKAGE EJER_1_A
     AS
     	PROCEDURE carga_table;
     	PROCEDURE insert_movimientos(COD NUMBER, COD_S NUMBER, NUM NUMBER, FECHA DATE, TIP VARCHAR2, IMP NUMBER);
     	PROCEDURE delete_cuenta(COD NUMBER, COD_S NUMBER, NUM NUMBER);
     END EJER_1_A;
     
     CREATE OR REPLACE PACKAGE BODY EJER_1_A
     AS
     
     TYPE t_cuentas IS TABLE OF CUENTAS%ROWTYPE INDEX BY BINARY_INTEGER;
     tab_cuentas t_cuentas;
     FUNCTION calculo (COD NUMBER, COD_S NUMBER, NUM NUMBER) RETURN NUMBER;
     
     PROCEDURE carga_table
     AS
     CURSOR C1 IS SELECT * FROM CUENTAS;
     BEGIN
     FOR V_REG IN C1 LOOP
     tab_cuentas(V_REG.COD_BANCO) :=V_REG;
     		END LOOP;
     	END carga_table;
     	
     PROCEDURE insert_movimientos(COD NUMBER, COD_S NUMBER, NUM NUMBER, FECHA DATE, TIP VARCHAR2, IMP NUMBER)
     AS
     v_calculo NUMBER(10);
     BEGIN
     carga_table;
     IF tab_cuentas.EXISTS(COD) THEN
     NULL;
     ELSE
     INSERT INTO CUENTAS VALUES(COD, COD_S, NUM, NULL, NULL, NULL, NULL, NULL, NULL);
     tab_cuentas.DELETE;
     carga_table;
     	END IF;
     	
     INSERT INTO MOVIMIENTOS VALUES(COD, COD_S, NUM, FECHA, TIP, IMP);
     v_calculo := calculo(COD, COD_S, NUM);
     UPDATE CUENTAS SET SALDO_HABER = v_calculo;
     END insert_movimientos;
     	
     PROCEDURE delete_cuenta (COD NUMBER, COD_S NUMBER, NUM NUMBER)
     AS
     CURSOR C1 IS SELECT * FROM MOVIMIENTOS WHERE COD_BANCO=COD AND COD_SUCUR=COD_S AND NUM_CTA=NUM FOR UPDATE;
     BEGIN
     carga_table;
     FOR V_REG IN C1 LOOP
     DELETE FROM MOVIMIENTOS WHERE CURRENT OF C1;
     END LOOP;
     DELETE FROM CUENTAS WHERE COD_BANCO=COD AND COD_SUCUR=COD_S AND NUM_CTA=NUM;
     tab_cuentas.DELETE;
     carga_table;
     END delete_cuenta;
     	
     FUNCTION calculo (COD NUMBER, COD_S NUMBER, NUM NUMBER)
     RETURN NUMBER
     AS
     v_calculo NUMBER(4);
     BEGIN
     SELECT SUM(IMPORTE) INTO v_calculo FROM MOVIMIENTOS WHERE COD_BANCO=COD AND COD_SUCUR=COD_S AND NUM_CTA=NUM;
     RETURN v_calculo;
     END calculo;
     END EJER_1_A;
     
     EJER.209
     
     CREATE OR REPLACE PACKAGE EJER_2_A
     AS
     PROCEDURE CARGAR_TABLA;
     PROCEDURE INSERT_EMPLE(EMP NUMBER, APE VARCHAR2, OFI VARCHAR2, D NUMBER, FECHA DATE, SAL NUMBER, COM NUMBER, DEPT NUMBER);
     PROCEDURE BORRAR_EMPLE(EMP NUMBER);
     FUNCTION BUSCAR_EMPLE(EMP NUMBER) RETURN VARCHAR2;
     END EJER_2_A;
     
     CREATE OR REPLACE PACKAGE BODY EJER_2_A
     AS
     
     TYPE  t_emple IS TABLE OF EMPLE%ROWTYPE INDEX BY BINARY_INTEGER;
     tab_emple t_emple;
     
     PROCEDURE CARGAR_TABLA
     AS
     CURSOR C1 IS SELECT * FROM EMPLE;
     BEGIN
     FOR V_REG IN C1 LOOP
     tab_emple(V_REG.EMP_NO) :=V_REG;
     END LOOP;
     END CARGAR_TABLA;
     
     PROCEDURE INSERT_EMPLE(EMP NUMBER, APE VARCHAR2, OFI VARCHAR2, D NUMBER, FECHA DATE, SAL NUMBER, COM NUMBER, DEPT NUMBER)
     AS
     BEGIN
     CARGAR_TABLA;
     INSERT INTO EMPLE VALUES(EMP, APE, OFI, D, FECHA, SAL, COM, DEPT);
     tab_emple.DELETE;
     CARGAR_TABLA;
     END INSERT_EMPLE;
     
     PROCEDURE BORRAR_EMPLE(EMP NUMBER)
     AS
     BEGIN
     CARGAR_TABLA;
     DELETE FROM EMPLE WHERE EMP_NO=EMP;
     tab_emple.DELETE(EMP);
     END BORRAR_EMPLE;
     
     FUNCTION BUSCAR_EMPLE(EMP NUMBER) 
     RETURN VARCHAR2
     AS
     v_ape VARCHAR2(30);
     BEGIN
     SELECT APELLIDO INTO v_ape FROM EMPLE WHERE EMP_NO=EMP;
     RETURN v_ape;
     END BUSCAR_EMPLE;
     
     END EJER_2_A;
     
     EJER.210
     CREATE OR REPLACE PACKAGE EJER_3_A
     AS
     PROCEDURE CARGAR_TABLA;
     PROCEDURE INSERTAR_DEPART(DEP NUMBER, DNOM VARCHAR2, LO VARCHAR2);
     PROCEDURE BORRAR_DEPART(DEP NUMBER);
     FUNCTION BUSCAR_EMPLE(DEP NUMBER) RETURN VARCHAR2;
     END EJER_3_A;
     
     CREATE OR REPLACE PACKAGE BODY EJER_3_A
     AS
     
     TYPE t_depart IS TABLE OF DEPART%ROWTYPE INDEX BY BINARY_INTEGER;
     tab_depart t_depart;
     
     PROCEDURE CARGAR_TABLA
     AS
     CURSOR C1 IS SELECT * FROM DEPART;
     BEGIN
     FOR V_REG IN C1 LOOP
     tab_depart(V_REG.DEPT_NO) :=V_REG;
     END LOOP;
     END CARGAR_TABLA;
     
     PROCEDURE INSERTAR_DEPART(DEP NUMBER, DNOM VARCHAR2, LO VARCHAR2)
     AS
     BEGIN
     CARGAR_TABLA;
     INSERT INTO DEPART VALUES(DEP, DNOM, LO);
     tab_depart.DELETE;
     CARGAR_TABLA;
     END INSERTAR_DEPART;
     
     PROCEDURE BORRAR_DEPART(DEP NUMBER)
     AS
     BEGIN
     tab_depart.DELETE(DEP);
     DELETE FROM DEPART WHERE DEPT_NO=DEP;
     END BORRAR_DEPART;
     
     FUNCTION BUSCAR_EMPLE(DEP NUMBER) 
     RETURN VARCHAR2
     AS
     v_dnom VARCHAR2(30);
     BEGIN
     SELECT DNOMBRE INTO v_dnom FROM DEPART WHERE DEPT_NO=DEP;
     RETURN (v_dnom);
     
     END BUSCAR_EMPLE;
     
     END EJER_3_A;


```